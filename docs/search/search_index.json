{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Vinti4Pay PHP SDK \u00b6 erilshk/vinti4pay-php - SDK PHP para integra\u00e7\u00e3o simples e segura com a plataforma Vinti4Net de Cabo Verde (SISP). Este SDK foi desenvolvido para facilitar a comunica\u00e7\u00e3o do seu projeto PHP com o gateway de pagamentos Vinti4Net , que opera a rede SISP em Cabo Verde. Ele abstrai as complexidades de seguran\u00e7a (como a gera\u00e7\u00e3o de fingerprint ) e formata\u00e7\u00e3o de requisi\u00e7\u00f5es, permitindo que voc\u00ea se concentre na l\u00f3gica de neg\u00f3cios do seu aplicativo. \u2728 Recursos Principais \u00b6 O Vinti4PayClient \u00e9 o ponto de entrada principal, oferecendo m\u00e9todos claros e encade\u00e1veis para gerenciar o ciclo de vida de uma transa\u00e7\u00e3o: Tipos de Transa\u00e7\u00e3o Suportados: Compras (Purchase) Pagamentos de Servi\u00e7os (Service Payment) Recargas (Recharge) Estornos (Refunds) Gera\u00e7\u00e3o de Formul\u00e1rios: Cria\u00e7\u00e3o autom\u00e1tica de formul\u00e1rios HTML, prontos para a submiss\u00e3o ao gateway, incluindo todos os campos de seguran\u00e7a necess\u00e1rios. Processamento de Callback : Valida\u00e7\u00e3o e interpreta\u00e7\u00e3o robusta das respostas ( callbacks ) enviadas pelo Vinti4Net, diferenciando automaticamente entre respostas de Pagamento e Estorno. Gest\u00e3o de Dados: M\u00e9todos dedicados para definir dados de billing obrigat\u00f3rios de forma validada ( setBillingParams ). DCC e Secure: Suporte impl\u00edcito para as funcionalidades de Dynamic Currency Conversion (DCC) e transa\u00e7\u00f5es 3D Secure. \ud83d\udce6 Detalhes T\u00e9cnicos \u00b6 Detalhe Valor Pacote Composer erilshk/vinti4pay-php Licen\u00e7a MIT Namespace Principal Erilshk\\Vinti4Pay Classe Central Vinti4PayClient \ud83d\udee0\ufe0f Requisitos de Ambiente \u00b6 Para rodar o SDK, seu ambiente deve atender aos seguintes requisitos: PHP: Vers\u00e3o 8.0 ou superior. Extens\u00f5es PHP: ext-json e ext-hash . Nota: \u00c9 altamente recomend\u00e1vel manter seu ambiente PHP atualizado para a melhor performance e seguran\u00e7a. \ud83d\ude80 Pr\u00f3ximos Passos \u00b6 Aprenda a integrar o SDK em seu projeto em apenas alguns passos: Instala\u00e7\u00e3o : Adicione a depend\u00eancia ao seu projeto via Composer. Configura\u00e7\u00e3o : Instancie o Vinti4PayClient com suas credenciais de POS. Uso : Veja como preparar suas primeiras transa\u00e7\u00f5es de pagamento. \ud83c\udf10 Suporte e Contato \u00b6 Reposit\u00f3rio: erilshackle/vinti4pay-php Relatar Problemas (Issues): erilshackle/vinti4pay-php/issues Autor: Eril TS Carvalho","title":"Introdu\u00e7\u00e3o"},{"location":"#vinti4pay-php-sdk","text":"erilshk/vinti4pay-php - SDK PHP para integra\u00e7\u00e3o simples e segura com a plataforma Vinti4Net de Cabo Verde (SISP). Este SDK foi desenvolvido para facilitar a comunica\u00e7\u00e3o do seu projeto PHP com o gateway de pagamentos Vinti4Net , que opera a rede SISP em Cabo Verde. Ele abstrai as complexidades de seguran\u00e7a (como a gera\u00e7\u00e3o de fingerprint ) e formata\u00e7\u00e3o de requisi\u00e7\u00f5es, permitindo que voc\u00ea se concentre na l\u00f3gica de neg\u00f3cios do seu aplicativo.","title":"Vinti4Pay PHP SDK"},{"location":"#recursos-principais","text":"O Vinti4PayClient \u00e9 o ponto de entrada principal, oferecendo m\u00e9todos claros e encade\u00e1veis para gerenciar o ciclo de vida de uma transa\u00e7\u00e3o: Tipos de Transa\u00e7\u00e3o Suportados: Compras (Purchase) Pagamentos de Servi\u00e7os (Service Payment) Recargas (Recharge) Estornos (Refunds) Gera\u00e7\u00e3o de Formul\u00e1rios: Cria\u00e7\u00e3o autom\u00e1tica de formul\u00e1rios HTML, prontos para a submiss\u00e3o ao gateway, incluindo todos os campos de seguran\u00e7a necess\u00e1rios. Processamento de Callback : Valida\u00e7\u00e3o e interpreta\u00e7\u00e3o robusta das respostas ( callbacks ) enviadas pelo Vinti4Net, diferenciando automaticamente entre respostas de Pagamento e Estorno. Gest\u00e3o de Dados: M\u00e9todos dedicados para definir dados de billing obrigat\u00f3rios de forma validada ( setBillingParams ). DCC e Secure: Suporte impl\u00edcito para as funcionalidades de Dynamic Currency Conversion (DCC) e transa\u00e7\u00f5es 3D Secure.","title":"\u2728 Recursos Principais"},{"location":"#detalhes-tecnicos","text":"Detalhe Valor Pacote Composer erilshk/vinti4pay-php Licen\u00e7a MIT Namespace Principal Erilshk\\Vinti4Pay Classe Central Vinti4PayClient","title":"\ud83d\udce6 Detalhes T\u00e9cnicos"},{"location":"#requisitos-de-ambiente","text":"Para rodar o SDK, seu ambiente deve atender aos seguintes requisitos: PHP: Vers\u00e3o 8.0 ou superior. Extens\u00f5es PHP: ext-json e ext-hash . Nota: \u00c9 altamente recomend\u00e1vel manter seu ambiente PHP atualizado para a melhor performance e seguran\u00e7a.","title":"\ud83d\udee0\ufe0f Requisitos de Ambiente"},{"location":"#proximos-passos","text":"Aprenda a integrar o SDK em seu projeto em apenas alguns passos: Instala\u00e7\u00e3o : Adicione a depend\u00eancia ao seu projeto via Composer. Configura\u00e7\u00e3o : Instancie o Vinti4PayClient com suas credenciais de POS. Uso : Veja como preparar suas primeiras transa\u00e7\u00f5es de pagamento.","title":"\ud83d\ude80 Pr\u00f3ximos Passos"},{"location":"#suporte-e-contato","text":"Reposit\u00f3rio: erilshackle/vinti4pay-php Relatar Problemas (Issues): erilshackle/vinti4pay-php/issues Autor: Eril TS Carvalho","title":"\ud83c\udf10 Suporte e Contato"},{"location":"callbacks/","text":"\ud83d\udc42 Callbacks e Respostas \u00b6 Ap\u00f3s o cliente interagir com o gateway Vinti4Net, o resultado da transa\u00e7\u00e3o \u00e9 enviado para a URL de Callback ( $responseUrl ) que voc\u00ea configurou. O Vinti4Pay SDK encapsula esse resultado na classe ResponseResult (DTO) , que fornece m\u00e9todos estruturados para verificar o status, acessar dados e garantir a seguran\u00e7a. 1. Processando a Resposta \u00b6 O m\u00e9todo processResponse(array $postData) \u00e9 o ponto de entrada no seu script de callback. Ele recebe os dados POST do Vinti4Net, realiza a valida\u00e7\u00e3o da fingerprint e retorna um objeto ResponseResult . Uso do processResponse \u00b6 use Erilshk\\Vinti4Pay\\Vinti4PayClient; use Erilshk\\Vinti4Pay\\Models\\ResponseResult; // Importe o DTO // 1. Instancie o cliente (com as mesmas credenciais usadas na requisi\u00e7\u00e3o) $client = new Vinti4PayClient($posID, $posAutCode); // 2. Processa os dados POST recebidos (O SDK valida a seguran\u00e7a automaticamente) /** @var ResponseResult $result */ $result = $client->processResponse($_POST); 2. Interpreta\u00e7\u00e3o do Objeto ResponseResult \u00b6 A classe ResponseResult simplifica a l\u00f3gica de verifica\u00e7\u00e3o de status e a gest\u00e3o de erros. M\u00e9todos de Verifica\u00e7\u00e3o de Status \u00b6 Utilize estes m\u00e9todos para construir a sua l\u00f3gica de neg\u00f3cio: M\u00e9todo Retorno Descri\u00e7\u00e3o isSuccessful() bool Retorna true se a transa\u00e7\u00e3o foi aprovada e segura . getStatus() string Retorna o status principal (constantes como 'SUCCESS' , 'CANCELLED' , 'INVALID_FINGERPRINT' ). getStatusLabel('pt') string Retorna o status em linguagem amig\u00e1vel (ex: \"Transa\u00e7\u00e3o bem-sucedida\"). getMessage() string Mensagem descritiva da transa\u00e7\u00e3o. Exemplo de L\u00f3gica no Script de Callback \u00b6 Seu script de callback deve usar isSuccessful() para determinar a aprova\u00e7\u00e3o: // ... (c\u00f3digo de instancia\u00e7\u00e3o e chamada ao processResponse) if ($result->isSuccessful()) { // \ud83c\udf89 Transa\u00e7\u00e3o APROVADA: \u00c9 seguro finalizar o pedido $transactionID = $result->getData()['transactionID'] ?? 'N/A'; // A\u00e7\u00e3o: // - Atualizar o status do pedido para 'PAGO'. // - Enviar email de confirma\u00e7\u00e3o. echo \"<h1>{$result->getStatusLabel('pt')}</h1>\"; echo \"<p>ID da Transa\u00e7\u00e3o: {$transactionID}</p>\"; } elseif ($result->isCancelled()) { // \u270b Cancelamento pelo Usu\u00e1rio echo \"<h1>Transa\u00e7\u00e3o Cancelada</h1>\"; echo \"<p>{$result->getMessage()}</p>\"; } elseif ($result->hasInvalidFingerprint()) { // \u26a0\ufe0f ALERTA CR\u00cdTICO: Integridade dos dados comprometida // A\u00e7\u00e3o: Registrar e notificar a equipa de seguran\u00e7a. echo \"<h1>Falha de Seguran\u00e7a: Fingerprint Inv\u00e1lida</h1>\"; } else { // \u274c Falha (ERROR) echo \"<h1>Falha no Pagamento</h1>\"; echo \"<p>Motivo: {$result->getMessage()}</p>\"; } 3. M\u00e9todos Encande\u00e1veis (Chaining) \u00b6 O ResponseResult suporta m\u00e9todos fluent (encade\u00e1veis) para a execu\u00e7\u00e3o de c\u00f3digo limpo com base no status, mantendo o c\u00f3digo organizado: $result->onSuccess(function (ResponseResult $r) { // L\u00f3gica para SUCCESSO echo \"Sucesso: Pedido #{$r->getData()['merchantRef']} pago.\"; })->onError(function (ResponseResult $r) { // L\u00f3gica para FALHA error_log(\"Transa\u00e7\u00e3o falhou: \" . $r->getMessage()); })->onCancel(function (ResponseResult $r) { // L\u00f3gica para CANCELAMENTO echo \"Pedido cancelado pelo utilizador.\"; }); 4. Acesso a Dados Brutos \u00b6 Utilize os seguintes m\u00e9todos para acessar os dados da transa\u00e7\u00e3o: getData() : Retorna o array completo e bruto dos campos POST recebidos do Vinti4Net. hasDcc() / getDcc() : Verifica\u00e7\u00e3o e acesso aos dados de Dynamic Currency Conversion (DCC), se a convers\u00e3o de moeda tiver sido aplicada. Pr\u00f3ximo Passo: Com a transa\u00e7\u00e3o validada, avance para a se\u00e7\u00e3o Recibo para aprender a gerar o comprovativo.","title":"Callbacks e Respostas"},{"location":"callbacks/#callbacks-e-respostas","text":"Ap\u00f3s o cliente interagir com o gateway Vinti4Net, o resultado da transa\u00e7\u00e3o \u00e9 enviado para a URL de Callback ( $responseUrl ) que voc\u00ea configurou. O Vinti4Pay SDK encapsula esse resultado na classe ResponseResult (DTO) , que fornece m\u00e9todos estruturados para verificar o status, acessar dados e garantir a seguran\u00e7a.","title":"\ud83d\udc42 Callbacks e Respostas"},{"location":"callbacks/#1-processando-a-resposta","text":"O m\u00e9todo processResponse(array $postData) \u00e9 o ponto de entrada no seu script de callback. Ele recebe os dados POST do Vinti4Net, realiza a valida\u00e7\u00e3o da fingerprint e retorna um objeto ResponseResult .","title":"1. Processando a Resposta"},{"location":"callbacks/#uso-do-processresponse","text":"use Erilshk\\Vinti4Pay\\Vinti4PayClient; use Erilshk\\Vinti4Pay\\Models\\ResponseResult; // Importe o DTO // 1. Instancie o cliente (com as mesmas credenciais usadas na requisi\u00e7\u00e3o) $client = new Vinti4PayClient($posID, $posAutCode); // 2. Processa os dados POST recebidos (O SDK valida a seguran\u00e7a automaticamente) /** @var ResponseResult $result */ $result = $client->processResponse($_POST);","title":"Uso do processResponse"},{"location":"callbacks/#2-interpretacao-do-objeto-responseresult","text":"A classe ResponseResult simplifica a l\u00f3gica de verifica\u00e7\u00e3o de status e a gest\u00e3o de erros.","title":"2. Interpreta\u00e7\u00e3o do Objeto ResponseResult"},{"location":"callbacks/#metodos-de-verificacao-de-status","text":"Utilize estes m\u00e9todos para construir a sua l\u00f3gica de neg\u00f3cio: M\u00e9todo Retorno Descri\u00e7\u00e3o isSuccessful() bool Retorna true se a transa\u00e7\u00e3o foi aprovada e segura . getStatus() string Retorna o status principal (constantes como 'SUCCESS' , 'CANCELLED' , 'INVALID_FINGERPRINT' ). getStatusLabel('pt') string Retorna o status em linguagem amig\u00e1vel (ex: \"Transa\u00e7\u00e3o bem-sucedida\"). getMessage() string Mensagem descritiva da transa\u00e7\u00e3o.","title":"M\u00e9todos de Verifica\u00e7\u00e3o de Status"},{"location":"callbacks/#exemplo-de-logica-no-script-de-callback","text":"Seu script de callback deve usar isSuccessful() para determinar a aprova\u00e7\u00e3o: // ... (c\u00f3digo de instancia\u00e7\u00e3o e chamada ao processResponse) if ($result->isSuccessful()) { // \ud83c\udf89 Transa\u00e7\u00e3o APROVADA: \u00c9 seguro finalizar o pedido $transactionID = $result->getData()['transactionID'] ?? 'N/A'; // A\u00e7\u00e3o: // - Atualizar o status do pedido para 'PAGO'. // - Enviar email de confirma\u00e7\u00e3o. echo \"<h1>{$result->getStatusLabel('pt')}</h1>\"; echo \"<p>ID da Transa\u00e7\u00e3o: {$transactionID}</p>\"; } elseif ($result->isCancelled()) { // \u270b Cancelamento pelo Usu\u00e1rio echo \"<h1>Transa\u00e7\u00e3o Cancelada</h1>\"; echo \"<p>{$result->getMessage()}</p>\"; } elseif ($result->hasInvalidFingerprint()) { // \u26a0\ufe0f ALERTA CR\u00cdTICO: Integridade dos dados comprometida // A\u00e7\u00e3o: Registrar e notificar a equipa de seguran\u00e7a. echo \"<h1>Falha de Seguran\u00e7a: Fingerprint Inv\u00e1lida</h1>\"; } else { // \u274c Falha (ERROR) echo \"<h1>Falha no Pagamento</h1>\"; echo \"<p>Motivo: {$result->getMessage()}</p>\"; }","title":"Exemplo de L\u00f3gica no Script de Callback"},{"location":"callbacks/#3-metodos-encandeaveis-chaining","text":"O ResponseResult suporta m\u00e9todos fluent (encade\u00e1veis) para a execu\u00e7\u00e3o de c\u00f3digo limpo com base no status, mantendo o c\u00f3digo organizado: $result->onSuccess(function (ResponseResult $r) { // L\u00f3gica para SUCCESSO echo \"Sucesso: Pedido #{$r->getData()['merchantRef']} pago.\"; })->onError(function (ResponseResult $r) { // L\u00f3gica para FALHA error_log(\"Transa\u00e7\u00e3o falhou: \" . $r->getMessage()); })->onCancel(function (ResponseResult $r) { // L\u00f3gica para CANCELAMENTO echo \"Pedido cancelado pelo utilizador.\"; });","title":"3. M\u00e9todos Encande\u00e1veis (Chaining)"},{"location":"callbacks/#4-acesso-a-dados-brutos","text":"Utilize os seguintes m\u00e9todos para acessar os dados da transa\u00e7\u00e3o: getData() : Retorna o array completo e bruto dos campos POST recebidos do Vinti4Net. hasDcc() / getDcc() : Verifica\u00e7\u00e3o e acesso aos dados de Dynamic Currency Conversion (DCC), se a convers\u00e3o de moeda tiver sido aplicada. Pr\u00f3ximo Passo: Com a transa\u00e7\u00e3o validada, avance para a se\u00e7\u00e3o Recibo para aprender a gerar o comprovativo.","title":"4. Acesso a Dados Brutos"},{"location":"changelog/","text":"\ud83d\udcc5 Hist\u00f3rico de Altera\u00e7\u00f5es \u00b6 Este documento lista as mudan\u00e7as por vers\u00e3o do Vinti4Pay PHP SDK . [1.0.0] - 2025-11-08 \u00b6 Lan\u00e7amento Inicial \u00b6 Lan\u00e7amento da primeira vers\u00e3o do SDK. Suporte total \u00e0s transa\u00e7\u00f5es: Compra, Servi\u00e7o, Recarga e Estorno. Implementa\u00e7\u00e3o da verifica\u00e7\u00e3o de seguran\u00e7a ( fingerprint ) no callback.","title":"Changelog"},{"location":"changelog/#historico-de-alteracoes","text":"Este documento lista as mudan\u00e7as por vers\u00e3o do Vinti4Pay PHP SDK .","title":"\ud83d\udcc5 Hist\u00f3rico de Altera\u00e7\u00f5es"},{"location":"changelog/#100-2025-11-08","text":"","title":"[1.0.0] - 2025-11-08"},{"location":"changelog/#lancamento-inicial","text":"Lan\u00e7amento da primeira vers\u00e3o do SDK. Suporte total \u00e0s transa\u00e7\u00f5es: Compra, Servi\u00e7o, Recarga e Estorno. Implementa\u00e7\u00e3o da verifica\u00e7\u00e3o de seguran\u00e7a ( fingerprint ) no callback.","title":"Lan\u00e7amento Inicial"},{"location":"examples/","text":"\ud83d\udecd\ufe0f Exemplo de Fluxo de Compra Completo (3 Arquivos) \u00b6 Este conjunto de exemplos simula o ciclo completo de uma transa\u00e7\u00e3o de Compra ( preparePurchase ), desde o checkout inicial at\u00e9 o callback final. \ud83d\udcdd Configura\u00e7\u00e3o: .env \u00b6 Recomenda-se o uso de um arquivo de config ou, preferencialmente, .env para gerenciar credenciais de forma segura e n\u00e3o expor em c\u00f3gidos abertos ou arquivos comitados. Conte\u00fado de .env : VINTI4_POS_ID = \"990000000\" VINTI4_AUT_CODE = \"A1B2C3D4E5F67890\" VINTI4_CALLBACK_URL = \"https://seusite.com/vinti4_callback.php\" VINTI4_ENDPOINT = \"https://mc.vinti4net.cv/BizMPIOnUsSisp/\" Arquivo 1: checkout.html (P\u00e1gina de Recolha de Dados) \u00b6 Esta p\u00e1gina recolhe os dados de billing e o valor da compra, enviando-os por POST para o script de processamento interno ( postback.php ). Assegure-se de neutralizar as tentativas de adultera\u00e7\u00e3o de dados do formul\u00e1rio, como pre\u00e7o . (ali\u00e1s, evite enviar o pre\u00e7o do formul\u00e1rio ao postback.php ) <!DOCTYPE html> < html lang = \"pt\" > < head > < meta charset = \"UTF-8\" > < title > Checkout de Compra Vinti4Pay </ title > </ head > < body > < h1 > 1. Iniciar Compra </ h1 > < form action = \"process_postback.php\" method = \"POST\" > < h2 > Detalhes da Compra </ h2 > <!-- O ideal seria pegar o pre\u00e7o diretamente na base de dados l\u00e1 no postback.php ou encriptar o pre\u00e7o aqui e desencriptar l\u00e1 no postback.php ! Nunca Envie o pre\u00e7o (unsafe) direto do formul\u00e1rio para o postback.php --> < label for = \"amount\" > Valor (CVE): </ label > < input type = \"number\" id = \"amount\" name = \"amount\" value = \"1250.00\" readonly >< br >< br > < h2 > Dados de Fatura\u00e7\u00e3o (Billing) </ h2 > < label for = \"email\" > Email: </ label > < input type = \"email\" id = \"email\" name = \"email\" value = \"cliente@exemplo.com\" required >< br > < label for = \"billAddrLine1\" > Morada (Linha 1): </ label > < input type = \"text\" id = \"billAddrLine1\" name = \"billAddrLine1\" value = \"Rua Central, 10\" required >< br > < label for = \"billAddrCity\" > Cidade: </ label > < input type = \"text\" id = \"billAddrCity\" name = \"billAddrCity\" value = \"Praia\" required >< br > < label for = \"billAddrPostCode\" > C\u00f3d. Postal: </ label > < input type = \"text\" id = \"billAddrPostCode\" name = \"billAddrPostCode\" value = \"7000\" required >< br > < input type = \"hidden\" name = \"billAddrCountry\" value = \"CV\" > < hr > < button type = \"submit\" > Pagar Compra com Vinti4Net </ button > </ form > </ body > </ html > Arquivo 2: postback.php (O Script de Processamento Interno) \u00b6 Este script prepara a transa\u00e7\u00e3o de Compra ( preparePurchase ), utilizando a estrutura correta dos par\u00e2metros de billing e carregando as configura\u00e7\u00f5es do .env . <?php /** * 2. Processamento do Postback: Prepara a transa\u00e7\u00e3o de COMPRA, * gera o formul\u00e1rio HTML e redireciona. */ require 'vendor/autoload.php' ; use Erilshk\\Vinti4Pay\\Vinti4PayClient ; use Erilshk\\Vinti4Pay\\Exceptions\\Vinti4Exception ; // --- CONFIGURA\u00c7\u00c3O --- $posID = getenv ( 'VINTI4_POS_ID' ); $posAutCode = getenv ( 'VINTI4_AUT_CODE' ); $callbackUrl = getenv ( 'VINTI4_CALLBACK_URL' ); // --- DADOS DO FORMUL\u00c1RIO --- $valorCompra = ( float ) ( $_POST [ 'amount' ] ?? 0 ); $merchantRef = 'PEDIDO_' . time (); $billing = [ 'email' => $_POST [ 'email' ] ?? '' , 'billAddrCountry' => $_POST [ 'billAddrCountry' ] ?? '132' , 'billAddrCity' => $_POST [ 'billAddrCity' ] ?? '' , 'billAddrLine1' => $_POST [ 'billAddrLine1' ] ?? '' , 'billAddrPostCode' => $_POST [ 'billAddrPostCode' ] ?? '' , ]; /* --- Usar Headers anti-cache seriam cruciais para evitar problemas no callback --- */ try { $client = new Vinti4PayClient ( $posID , $posAutCode ); // Preparar a Transa\u00e7\u00e3o de Compra (Tipo 1) $client -> preparePurchase ( amount : $valorCompra , billing : $billing , merchantRef : $merchantRef , merchantSession : session_id () ); // Gerar o Formul\u00e1rio HTML de Redirecionamento $htmlForm = $client -> createPaymentForm ( $callbackUrl ); echo $htmlForm ; // O redirecionamento \u00e9 feito via JS contido no formul\u00e1rio } catch ( Vinti4Exception $e ) { http_response_code ( 500 ); echo \"Erro ao preparar a compra: \" . $e -> getMessage (); } exit ; Arquivo 3: vinti4_callback.php (O Script de Callback/Resposta) \u00b6 Este script processa a resposta da Vinti4Net, aplica os headers anti-cache para garantir o funcionamento do postback e utiliza o ResponseResult para a l\u00f3gica de neg\u00f3cio. <?php /** * 3. Script de Callback (Postback): Valida a seguran\u00e7a e processa o resultado da COMPRA. */ require 'vendor/autoload.php' ; use Erilshk\\Vinti4Pay\\Vinti4PayClient ; use Erilshk\\Vinti4Pay\\Models\\ResponseResult ; use Erilshk\\Vinti4Pay\\Exceptions\\Vinti4Exception ; use Dotenv\\Dotenv ; // Para carregar o .env // Carregar vari\u00e1veis de ambiente Dotenv :: createImmutable ( __DIR__ ) -> safeLoad (); // --- CONFIGURA\u00c7\u00c3O --- $posID = getenv ( 'VINTI4_POS_ID' ); $posAutCode = getenv ( 'VINTI4_AUT_CODE' ); /* --- Headers anti-cache s\u00e3o cruciais --- */ $postData = $_POST ; echo \"<html><body>\" ; echo \"<h1>3. Processamento Final da Compra</h1>\" ; try { $client = new Vinti4PayClient ( $posID , $posAutCode ); /** @var ResponseResult $result */ $result = $client -> processResponse ( $postData ); // --- L\u00d3GICA DE NEG\u00d3CIO --- $result -> onSuccess ( function ( ResponseResult $r ) { // \ud83c\udf89 COMPRA Aprovada e Segura! $ref = $r -> getData ()[ 'merchantRespMerchantRef' ] ?? 'N/A' ; // ** A\u00c7\u00c3O: Atualizar o status do pedido no Banco de Dados ** echo \"<h2>\u2705 Compra Confirmada!</h2>\" ; echo \"<p>Refer\u00eancia: ** { $ref } **</p>\" ; echo $r -> generateClientReceipt (); }) -> onError ( function ( ResponseResult $r ) { // \u274c Falha na Compra // ** A\u00c7\u00c3O: Marcar como FALHA ** echo \"<h2>\u274c Compra N\u00e3o Aprovada.</h2>\" ; echo \"<p>Motivo: ** { $r -> getMessage () } **</p>\" ; }) -> onCancel ( function ( ResponseResult $r ) { // \u270b Cancelamento pelo Usu\u00e1rio // ** A\u00c7\u00c3O: Marcar como CANCELADO ** echo \"<h2>\u274c Compra Cancelada.</h2>\" ; }); } catch ( Vinti4Exception $e ) { // \u26a0\ufe0f ERRO DE SEGURAN\u00c7A ou ERRO CR\u00cdTICO http_response_code ( 403 ); error_log ( \"Alerta de Seguran\u00e7a/Erro Cr\u00edtico: \" . $e -> getMessage ()); echo \"<h2>\ud83d\udeab Erro Cr\u00edtico.</h2>\" ; echo \"<p>A transa\u00e7\u00e3o n\u00e3o p\u00f4de ser validada.</p>\" ; } echo \"</body></html>\" ; \ud83d\uded1 Headers Anti-Cache Recomendados \u00b6 Para garantir que o seu script de Callback ( vinti4_callback.php ) processe a resposta da Vinti4Net de forma fi\u00e1vel e n\u00e3o seja armazenado em cache por proxies ou navegadores, deve incluir os seguintes headers no topo do seu arquivo de callback : header(\"Cache-Control: no-store, no-cache, must-revalidate, max-age=0\"); header(\"Cache-Control: post-check=0, pre-check=0\", false); header(\"Pragma: no-cache\"); Porqu\u00ea Usar Estes Headers? \u00b6 Estes headers for\u00e7am o navegador e qualquer servidor intermedi\u00e1rio a buscar o conte\u00fado da p\u00e1gina novamente em cada acesso, garantindo que o $_POST (que cont\u00e9m os dados cr\u00edticos da transa\u00e7\u00e3o) n\u00e3o seja perdido ou reutilizado de uma c\u00f3pia em cache. Isso \u00e9 vital para a seguran\u00e7a e o processamento correto do processResponse() .","title":"Exemplos"},{"location":"examples/#exemplo-de-fluxo-de-compra-completo-3-arquivos","text":"Este conjunto de exemplos simula o ciclo completo de uma transa\u00e7\u00e3o de Compra ( preparePurchase ), desde o checkout inicial at\u00e9 o callback final.","title":"\ud83d\udecd\ufe0f Exemplo de Fluxo de Compra Completo (3 Arquivos)"},{"location":"examples/#configuracao-env","text":"Recomenda-se o uso de um arquivo de config ou, preferencialmente, .env para gerenciar credenciais de forma segura e n\u00e3o expor em c\u00f3gidos abertos ou arquivos comitados. Conte\u00fado de .env : VINTI4_POS_ID = \"990000000\" VINTI4_AUT_CODE = \"A1B2C3D4E5F67890\" VINTI4_CALLBACK_URL = \"https://seusite.com/vinti4_callback.php\" VINTI4_ENDPOINT = \"https://mc.vinti4net.cv/BizMPIOnUsSisp/\"","title":"\ud83d\udcdd Configura\u00e7\u00e3o: .env"},{"location":"examples/#arquivo-1-checkouthtml-pagina-de-recolha-de-dados","text":"Esta p\u00e1gina recolhe os dados de billing e o valor da compra, enviando-os por POST para o script de processamento interno ( postback.php ). Assegure-se de neutralizar as tentativas de adultera\u00e7\u00e3o de dados do formul\u00e1rio, como pre\u00e7o . (ali\u00e1s, evite enviar o pre\u00e7o do formul\u00e1rio ao postback.php ) <!DOCTYPE html> < html lang = \"pt\" > < head > < meta charset = \"UTF-8\" > < title > Checkout de Compra Vinti4Pay </ title > </ head > < body > < h1 > 1. Iniciar Compra </ h1 > < form action = \"process_postback.php\" method = \"POST\" > < h2 > Detalhes da Compra </ h2 > <!-- O ideal seria pegar o pre\u00e7o diretamente na base de dados l\u00e1 no postback.php ou encriptar o pre\u00e7o aqui e desencriptar l\u00e1 no postback.php ! Nunca Envie o pre\u00e7o (unsafe) direto do formul\u00e1rio para o postback.php --> < label for = \"amount\" > Valor (CVE): </ label > < input type = \"number\" id = \"amount\" name = \"amount\" value = \"1250.00\" readonly >< br >< br > < h2 > Dados de Fatura\u00e7\u00e3o (Billing) </ h2 > < label for = \"email\" > Email: </ label > < input type = \"email\" id = \"email\" name = \"email\" value = \"cliente@exemplo.com\" required >< br > < label for = \"billAddrLine1\" > Morada (Linha 1): </ label > < input type = \"text\" id = \"billAddrLine1\" name = \"billAddrLine1\" value = \"Rua Central, 10\" required >< br > < label for = \"billAddrCity\" > Cidade: </ label > < input type = \"text\" id = \"billAddrCity\" name = \"billAddrCity\" value = \"Praia\" required >< br > < label for = \"billAddrPostCode\" > C\u00f3d. Postal: </ label > < input type = \"text\" id = \"billAddrPostCode\" name = \"billAddrPostCode\" value = \"7000\" required >< br > < input type = \"hidden\" name = \"billAddrCountry\" value = \"CV\" > < hr > < button type = \"submit\" > Pagar Compra com Vinti4Net </ button > </ form > </ body > </ html >","title":"Arquivo 1: checkout.html (P\u00e1gina de Recolha de Dados)"},{"location":"examples/#arquivo-2-postbackphp-o-script-de-processamento-interno","text":"Este script prepara a transa\u00e7\u00e3o de Compra ( preparePurchase ), utilizando a estrutura correta dos par\u00e2metros de billing e carregando as configura\u00e7\u00f5es do .env . <?php /** * 2. Processamento do Postback: Prepara a transa\u00e7\u00e3o de COMPRA, * gera o formul\u00e1rio HTML e redireciona. */ require 'vendor/autoload.php' ; use Erilshk\\Vinti4Pay\\Vinti4PayClient ; use Erilshk\\Vinti4Pay\\Exceptions\\Vinti4Exception ; // --- CONFIGURA\u00c7\u00c3O --- $posID = getenv ( 'VINTI4_POS_ID' ); $posAutCode = getenv ( 'VINTI4_AUT_CODE' ); $callbackUrl = getenv ( 'VINTI4_CALLBACK_URL' ); // --- DADOS DO FORMUL\u00c1RIO --- $valorCompra = ( float ) ( $_POST [ 'amount' ] ?? 0 ); $merchantRef = 'PEDIDO_' . time (); $billing = [ 'email' => $_POST [ 'email' ] ?? '' , 'billAddrCountry' => $_POST [ 'billAddrCountry' ] ?? '132' , 'billAddrCity' => $_POST [ 'billAddrCity' ] ?? '' , 'billAddrLine1' => $_POST [ 'billAddrLine1' ] ?? '' , 'billAddrPostCode' => $_POST [ 'billAddrPostCode' ] ?? '' , ]; /* --- Usar Headers anti-cache seriam cruciais para evitar problemas no callback --- */ try { $client = new Vinti4PayClient ( $posID , $posAutCode ); // Preparar a Transa\u00e7\u00e3o de Compra (Tipo 1) $client -> preparePurchase ( amount : $valorCompra , billing : $billing , merchantRef : $merchantRef , merchantSession : session_id () ); // Gerar o Formul\u00e1rio HTML de Redirecionamento $htmlForm = $client -> createPaymentForm ( $callbackUrl ); echo $htmlForm ; // O redirecionamento \u00e9 feito via JS contido no formul\u00e1rio } catch ( Vinti4Exception $e ) { http_response_code ( 500 ); echo \"Erro ao preparar a compra: \" . $e -> getMessage (); } exit ;","title":"Arquivo 2: postback.php (O Script de Processamento Interno)"},{"location":"examples/#arquivo-3-vinti4_callbackphp-o-script-de-callbackresposta","text":"Este script processa a resposta da Vinti4Net, aplica os headers anti-cache para garantir o funcionamento do postback e utiliza o ResponseResult para a l\u00f3gica de neg\u00f3cio. <?php /** * 3. Script de Callback (Postback): Valida a seguran\u00e7a e processa o resultado da COMPRA. */ require 'vendor/autoload.php' ; use Erilshk\\Vinti4Pay\\Vinti4PayClient ; use Erilshk\\Vinti4Pay\\Models\\ResponseResult ; use Erilshk\\Vinti4Pay\\Exceptions\\Vinti4Exception ; use Dotenv\\Dotenv ; // Para carregar o .env // Carregar vari\u00e1veis de ambiente Dotenv :: createImmutable ( __DIR__ ) -> safeLoad (); // --- CONFIGURA\u00c7\u00c3O --- $posID = getenv ( 'VINTI4_POS_ID' ); $posAutCode = getenv ( 'VINTI4_AUT_CODE' ); /* --- Headers anti-cache s\u00e3o cruciais --- */ $postData = $_POST ; echo \"<html><body>\" ; echo \"<h1>3. Processamento Final da Compra</h1>\" ; try { $client = new Vinti4PayClient ( $posID , $posAutCode ); /** @var ResponseResult $result */ $result = $client -> processResponse ( $postData ); // --- L\u00d3GICA DE NEG\u00d3CIO --- $result -> onSuccess ( function ( ResponseResult $r ) { // \ud83c\udf89 COMPRA Aprovada e Segura! $ref = $r -> getData ()[ 'merchantRespMerchantRef' ] ?? 'N/A' ; // ** A\u00c7\u00c3O: Atualizar o status do pedido no Banco de Dados ** echo \"<h2>\u2705 Compra Confirmada!</h2>\" ; echo \"<p>Refer\u00eancia: ** { $ref } **</p>\" ; echo $r -> generateClientReceipt (); }) -> onError ( function ( ResponseResult $r ) { // \u274c Falha na Compra // ** A\u00c7\u00c3O: Marcar como FALHA ** echo \"<h2>\u274c Compra N\u00e3o Aprovada.</h2>\" ; echo \"<p>Motivo: ** { $r -> getMessage () } **</p>\" ; }) -> onCancel ( function ( ResponseResult $r ) { // \u270b Cancelamento pelo Usu\u00e1rio // ** A\u00c7\u00c3O: Marcar como CANCELADO ** echo \"<h2>\u274c Compra Cancelada.</h2>\" ; }); } catch ( Vinti4Exception $e ) { // \u26a0\ufe0f ERRO DE SEGURAN\u00c7A ou ERRO CR\u00cdTICO http_response_code ( 403 ); error_log ( \"Alerta de Seguran\u00e7a/Erro Cr\u00edtico: \" . $e -> getMessage ()); echo \"<h2>\ud83d\udeab Erro Cr\u00edtico.</h2>\" ; echo \"<p>A transa\u00e7\u00e3o n\u00e3o p\u00f4de ser validada.</p>\" ; } echo \"</body></html>\" ;","title":"Arquivo 3: vinti4_callback.php (O Script de Callback/Resposta)"},{"location":"examples/#headers-anti-cache-recomendados","text":"Para garantir que o seu script de Callback ( vinti4_callback.php ) processe a resposta da Vinti4Net de forma fi\u00e1vel e n\u00e3o seja armazenado em cache por proxies ou navegadores, deve incluir os seguintes headers no topo do seu arquivo de callback : header(\"Cache-Control: no-store, no-cache, must-revalidate, max-age=0\"); header(\"Cache-Control: post-check=0, pre-check=0\", false); header(\"Pragma: no-cache\");","title":"\ud83d\uded1 Headers Anti-Cache Recomendados"},{"location":"examples/#porque-usar-estes-headers","text":"Estes headers for\u00e7am o navegador e qualquer servidor intermedi\u00e1rio a buscar o conte\u00fado da p\u00e1gina novamente em cada acesso, garantindo que o $_POST (que cont\u00e9m os dados cr\u00edticos da transa\u00e7\u00e3o) n\u00e3o seja perdido ou reutilizado de uma c\u00f3pia em cache. Isso \u00e9 vital para a seguran\u00e7a e o processamento correto do processResponse() .","title":"Porqu\u00ea Usar Estes Headers?"},{"location":"installation/","text":"\ud83d\udee0\ufe0f Instala\u00e7\u00e3o \u00b6 O Vinti4Pay PHP SDK \u00e9 uma biblioteca open-source com dois m\u00e9todos de instala\u00e7\u00e3o: o recomendado via Composer e uma op\u00e7\u00e3o standalone para ambientes que n\u00e3o utilizam gerenciadores de depend\u00eancias. 1. Requisitos Pr\u00e9vios \u00b6 Seu ambiente de desenvolvimento ou produ\u00e7\u00e3o deve atender aos seguintes requisitos: PHP: Vers\u00e3o 8.0 ou superior ( \"php\": \">=8.0\" ). Extens\u00f5es PHP: ext-json e ext-hash . 2. Op\u00e7\u00e3o Recomendada: Instala\u00e7\u00e3o via Composer \u00b6 O Composer \u00e9 a maneira mais f\u00e1cil, segura e moderna de instalar e gerenciar o SDK. O pacote est\u00e1 publicado no Packagist sob o nome erilshk/vinti4pay-php . Instala\u00e7\u00e3o \u00b6 Execute o seguinte comando no terminal do diret\u00f3rio raiz do seu projeto: composer require erilshk/vinti4pay-php Incluir o Autoload \u00b6 O Composer se encarrega de carregar automaticamente a classe Vinti4PayClient (e suas depend\u00eancias internas) usando o autoload PSR-4. Certifique-se de que a seguinte linha est\u00e1 presente no ponto de entrada da sua aplica\u00e7\u00e3o: require 'vendor/autoload.php'; 3. Op\u00e7\u00e3o Alternativa: Uso Standalone (solo) \u00b6 Para ambientes que n\u00e3o utilizam o Composer, o SDK oferece um modo de integra\u00e7\u00e3o manual que \u00e9 extremamente simples. \ud83c\udf1f Vantagem Principal: Esta vers\u00e3o \u00e9 totalmente autossuficiente. A classe Vinti4PayClient \u00e9 um arquivo \u00fanico que n\u00e3o possui depend\u00eancias externas, nem requer classes de modelo ou auxiliares do SDK. Ela faz o trabalho completo e retorna dados simples (como arrays ) onde necess\u00e1rio, fornecendo mesma interface do Ciente SDK. Processo Manual \u00b6 Download: Baixe o arquivo principal do SDK ( Vinti4PayClient.php ) do reposit\u00f3rio GitHub. Inclus\u00e3o: Coloque o arquivo em um local acess\u00edvel no seu projeto e use require_once para carreg\u00e1-lo. Exemplo de Uso Manual (M\u00e1xima Simplicidade): // Inclua APENAS o arquivo principal Vinti4PayClient.php require_once 'caminho/para/Vinti4PayClient.php'; // A partir daqui, o uso do SDK \u00e9 id\u00eantico ao uso via Composer. $client = new Vinti4PayClient($posID, $posAutCode); \ud83d\udcca Estat\u00edsticas do SDK \u00b6 O n\u00famero de instala\u00e7\u00f5es reflete a ado\u00e7\u00e3o e a estabilidade do SDK na comunidade PHP. Reposit\u00f3rio Status Packagist erilshk/vinti4pay-php Latest Release Monthly Downloads \ud83d\udd17 Verifica\u00e7\u00e3o: Para ver os dados de downloads em tempo real, visite a p\u00e1gina do pacote no Packagist . Pr\u00f3ximo Passo: Com o SDK instalado, avance para a Configura\u00e7\u00e3o das suas credenciais de POS para come\u00e7ar a us\u00e1-lo.","title":"Instala\u00e7\u00e3o"},{"location":"installation/#instalacao","text":"O Vinti4Pay PHP SDK \u00e9 uma biblioteca open-source com dois m\u00e9todos de instala\u00e7\u00e3o: o recomendado via Composer e uma op\u00e7\u00e3o standalone para ambientes que n\u00e3o utilizam gerenciadores de depend\u00eancias.","title":"\ud83d\udee0\ufe0f Instala\u00e7\u00e3o"},{"location":"installation/#1-requisitos-previos","text":"Seu ambiente de desenvolvimento ou produ\u00e7\u00e3o deve atender aos seguintes requisitos: PHP: Vers\u00e3o 8.0 ou superior ( \"php\": \">=8.0\" ). Extens\u00f5es PHP: ext-json e ext-hash .","title":"1. Requisitos Pr\u00e9vios"},{"location":"installation/#2-opcao-recomendada-instalacao-via-composer","text":"O Composer \u00e9 a maneira mais f\u00e1cil, segura e moderna de instalar e gerenciar o SDK. O pacote est\u00e1 publicado no Packagist sob o nome erilshk/vinti4pay-php .","title":"2. Op\u00e7\u00e3o Recomendada: Instala\u00e7\u00e3o via Composer"},{"location":"installation/#instalacao_1","text":"Execute o seguinte comando no terminal do diret\u00f3rio raiz do seu projeto: composer require erilshk/vinti4pay-php","title":"Instala\u00e7\u00e3o"},{"location":"installation/#incluir-o-autoload","text":"O Composer se encarrega de carregar automaticamente a classe Vinti4PayClient (e suas depend\u00eancias internas) usando o autoload PSR-4. Certifique-se de que a seguinte linha est\u00e1 presente no ponto de entrada da sua aplica\u00e7\u00e3o: require 'vendor/autoload.php';","title":"Incluir o Autoload"},{"location":"installation/#3-opcao-alternativa-uso-standalone-solo","text":"Para ambientes que n\u00e3o utilizam o Composer, o SDK oferece um modo de integra\u00e7\u00e3o manual que \u00e9 extremamente simples. \ud83c\udf1f Vantagem Principal: Esta vers\u00e3o \u00e9 totalmente autossuficiente. A classe Vinti4PayClient \u00e9 um arquivo \u00fanico que n\u00e3o possui depend\u00eancias externas, nem requer classes de modelo ou auxiliares do SDK. Ela faz o trabalho completo e retorna dados simples (como arrays ) onde necess\u00e1rio, fornecendo mesma interface do Ciente SDK.","title":"3. Op\u00e7\u00e3o Alternativa: Uso Standalone (solo)"},{"location":"installation/#processo-manual","text":"Download: Baixe o arquivo principal do SDK ( Vinti4PayClient.php ) do reposit\u00f3rio GitHub. Inclus\u00e3o: Coloque o arquivo em um local acess\u00edvel no seu projeto e use require_once para carreg\u00e1-lo. Exemplo de Uso Manual (M\u00e1xima Simplicidade): // Inclua APENAS o arquivo principal Vinti4PayClient.php require_once 'caminho/para/Vinti4PayClient.php'; // A partir daqui, o uso do SDK \u00e9 id\u00eantico ao uso via Composer. $client = new Vinti4PayClient($posID, $posAutCode);","title":"Processo Manual"},{"location":"installation/#estatisticas-do-sdk","text":"O n\u00famero de instala\u00e7\u00f5es reflete a ado\u00e7\u00e3o e a estabilidade do SDK na comunidade PHP. Reposit\u00f3rio Status Packagist erilshk/vinti4pay-php Latest Release Monthly Downloads \ud83d\udd17 Verifica\u00e7\u00e3o: Para ver os dados de downloads em tempo real, visite a p\u00e1gina do pacote no Packagist . Pr\u00f3ximo Passo: Com o SDK instalado, avance para a Configura\u00e7\u00e3o das suas credenciais de POS para come\u00e7ar a us\u00e1-lo.","title":"\ud83d\udcca Estat\u00edsticas do SDK"},{"location":"receipt/","text":"\ud83e\uddfe Recibo e Comprovativos \u00b6 O SDK oferece duas abordagens para a gera\u00e7\u00e3o de comprovativos (recibos), dependendo da necessidade de customiza\u00e7\u00e3o: Gera\u00e7\u00e3o Simplificada: Direto no objeto ResponseResult . Gera\u00e7\u00e3o Customizada: Utilizando a classe dedicada Erilshk\\Vinti4Pay\\Models\\Receipt . 1. Gera\u00e7\u00e3o Simplificada (Via ResponseResult) \u00b6 O objeto ResponseResult (retornado por processResponse() ) j\u00e1 inclui m\u00e9todos r\u00e1pidos que geram HTML formatado a partir dos dados da transa\u00e7\u00e3o, sem a necessidade de instanciar a classe Receipt . M\u00e9todos Dispon\u00edveis no ResponseResult \u00b6 M\u00e9todo Prop\u00f3sito generateReceipt() Gera um recibo em HTML t\u00e9cnico e detalhado, ideal para auditoria. generateClientReceipt() Gera um recibo em HTML resumido e amig\u00e1vel para o cliente final. getMerchantReceipt() Retorna o HTML do recibo original (campo merchantRespClientReceipt ) enviado pela Vinti4Net. Exemplo de Uso R\u00e1pido \u00b6 use Erilshk\\Vinti4Pay\\Models\\ResponseResult; /** @var ResponseResult $result */ // ... (ap\u00f3s processamento bem-sucedido) if ($result->isSuccessful()) { // Exibe o comprovativo simples para o cliente echo $result->generateClientReceipt(); // Opcional: Registra o recibo t\u00e9cnico no log error_log(\"Recibo T\u00e9cnico: \" . $result->generateReceipt()); } 2. Gera\u00e7\u00e3o Customizada (Via Classe Receipt ) \u00b6 Para cen\u00e1rios que exigem templates customizados ou inje\u00e7\u00e3o de par\u00e2metros adicionais, voc\u00ea deve usar a classe Receipt . O Vinti4PayClient fornece um helper simples para instanciar esta classe: M\u00e9todo $client->receipt() \u00b6 use Erilshk\\Vinti4Pay\\Vinti4PayClient; use Erilshk\\Vinti4Pay\\Models\\Receipt; // 1. Instancie o cliente $client = new Vinti4PayClient($posID, $posAutCode); // 2. Obtenha os dados da transa\u00e7\u00e3o (ex: do ResponseResult ou do seu banco de dados) $transactionData = $result->getData(); // 3. Utilize o helper do cliente para instanciar a classe Receipt /** @var Receipt $receipt */ $receipt = $client->receipt($transactionData); Utiliza\u00e7\u00e3o de Templates e Customiza\u00e7\u00e3o \u00b6 Ap\u00f3s instanciar o objeto $receipt , utilize o m\u00e9todo generateReceipt() para aplicar templates customizados e injetar dados extras. Templates Padr\u00e3o: O SDK procura os arquivos HTML (ex: transaction_receipt.html ) no diret\u00f3rio padr\u00e3o. M\u00e9todo Descri\u00e7\u00e3o generateReceipt(?string $template, array $params) Gera o HTML usando um template espec\u00edfico ou o template padr\u00e3o determinado pelo tipo de transa\u00e7\u00e3o (Compra, Estorno, Servi\u00e7o). saveReceipt(string $path, ...) Gera o recibo e salva o HTML diretamente em um arquivo no caminho especificado. Exemplo de Customiza\u00e7\u00e3o: // Injetar o nome da entidade e uma mensagem de rodap\u00e9 $params = [ 'ENTITY' => 'Empresa XPTO', 'FOOTER' => 'Obrigado por utilizar os nossos servi\u00e7os!', ]; // O template \"service_custom\" deve existir no diret\u00f3rio de templates ou ser passado como caminho absoluto $htmlReciboCustomizado = $receipt->generateReceipt('service_custom', $params); echo $htmlReciboCustomizado; Pr\u00f3ximo Passo: Explore o hist\u00f3rico de altera\u00e7\u00f5es da sua biblioteca na se\u00e7\u00e3o Changelog .","title":"Recibo"},{"location":"receipt/#recibo-e-comprovativos","text":"O SDK oferece duas abordagens para a gera\u00e7\u00e3o de comprovativos (recibos), dependendo da necessidade de customiza\u00e7\u00e3o: Gera\u00e7\u00e3o Simplificada: Direto no objeto ResponseResult . Gera\u00e7\u00e3o Customizada: Utilizando a classe dedicada Erilshk\\Vinti4Pay\\Models\\Receipt .","title":"\ud83e\uddfe Recibo e Comprovativos"},{"location":"receipt/#1-geracao-simplificada-via-responseresult","text":"O objeto ResponseResult (retornado por processResponse() ) j\u00e1 inclui m\u00e9todos r\u00e1pidos que geram HTML formatado a partir dos dados da transa\u00e7\u00e3o, sem a necessidade de instanciar a classe Receipt .","title":"1. Gera\u00e7\u00e3o Simplificada (Via ResponseResult)"},{"location":"receipt/#metodos-disponiveis-no-responseresult","text":"M\u00e9todo Prop\u00f3sito generateReceipt() Gera um recibo em HTML t\u00e9cnico e detalhado, ideal para auditoria. generateClientReceipt() Gera um recibo em HTML resumido e amig\u00e1vel para o cliente final. getMerchantReceipt() Retorna o HTML do recibo original (campo merchantRespClientReceipt ) enviado pela Vinti4Net.","title":"M\u00e9todos Dispon\u00edveis no ResponseResult"},{"location":"receipt/#exemplo-de-uso-rapido","text":"use Erilshk\\Vinti4Pay\\Models\\ResponseResult; /** @var ResponseResult $result */ // ... (ap\u00f3s processamento bem-sucedido) if ($result->isSuccessful()) { // Exibe o comprovativo simples para o cliente echo $result->generateClientReceipt(); // Opcional: Registra o recibo t\u00e9cnico no log error_log(\"Recibo T\u00e9cnico: \" . $result->generateReceipt()); }","title":"Exemplo de Uso R\u00e1pido"},{"location":"receipt/#2-geracao-customizada-via-classe-receipt","text":"Para cen\u00e1rios que exigem templates customizados ou inje\u00e7\u00e3o de par\u00e2metros adicionais, voc\u00ea deve usar a classe Receipt . O Vinti4PayClient fornece um helper simples para instanciar esta classe:","title":"2. Gera\u00e7\u00e3o Customizada (Via Classe Receipt)"},{"location":"receipt/#metodo-client-receipt","text":"use Erilshk\\Vinti4Pay\\Vinti4PayClient; use Erilshk\\Vinti4Pay\\Models\\Receipt; // 1. Instancie o cliente $client = new Vinti4PayClient($posID, $posAutCode); // 2. Obtenha os dados da transa\u00e7\u00e3o (ex: do ResponseResult ou do seu banco de dados) $transactionData = $result->getData(); // 3. Utilize o helper do cliente para instanciar a classe Receipt /** @var Receipt $receipt */ $receipt = $client->receipt($transactionData);","title":"M\u00e9todo $client-&gt;receipt()"},{"location":"receipt/#utilizacao-de-templates-e-customizacao","text":"Ap\u00f3s instanciar o objeto $receipt , utilize o m\u00e9todo generateReceipt() para aplicar templates customizados e injetar dados extras. Templates Padr\u00e3o: O SDK procura os arquivos HTML (ex: transaction_receipt.html ) no diret\u00f3rio padr\u00e3o. M\u00e9todo Descri\u00e7\u00e3o generateReceipt(?string $template, array $params) Gera o HTML usando um template espec\u00edfico ou o template padr\u00e3o determinado pelo tipo de transa\u00e7\u00e3o (Compra, Estorno, Servi\u00e7o). saveReceipt(string $path, ...) Gera o recibo e salva o HTML diretamente em um arquivo no caminho especificado. Exemplo de Customiza\u00e7\u00e3o: // Injetar o nome da entidade e uma mensagem de rodap\u00e9 $params = [ 'ENTITY' => 'Empresa XPTO', 'FOOTER' => 'Obrigado por utilizar os nossos servi\u00e7os!', ]; // O template \"service_custom\" deve existir no diret\u00f3rio de templates ou ser passado como caminho absoluto $htmlReciboCustomizado = $receipt->generateReceipt('service_custom', $params); echo $htmlReciboCustomizado; Pr\u00f3ximo Passo: Explore o hist\u00f3rico de altera\u00e7\u00f5es da sua biblioteca na se\u00e7\u00e3o Changelog .","title":"Utiliza\u00e7\u00e3o de Templates e Customiza\u00e7\u00e3o"},{"location":"reference/","text":"\ud83d\udee0\ufe0f API Vinti4Pay \u2013 Refer\u00eancia Completa \u00b6 1. Vinti4PayClient \u00b6 Namespace: Erilshk\\Vinti4Pay # Classe principal para todas as opera\u00e7\u00f5es com a Vinti4Net Construtor \u00b6 # Inicializa o cliente Vinti4Pay __construct( string $posID, # ID do ponto de venda (POS) string $posAutCode, # C\u00f3digo de autoriza\u00e7\u00e3o do POS ?string $endpoint = null # URL do endpoint da API (opcional, usado para ambiente de testes) ) Configura\u00e7\u00e3o \u00b6 # Define dados de faturamento do cliente setBillingParams( string $email, # Email do cliente string $country, # C\u00f3digo do pa\u00eds (ISO ou num\u00e9rico) string $city, # Cidade de faturamento string $address, # Endere\u00e7o de faturamento string $postCode, # C\u00f3digo postal array $aditional = [] # Campos opcionais (telefones, endere\u00e7o de envio, acctID, etc.) ): static # Retorna a inst\u00e2ncia do cliente para encadeamento de m\u00e9todos # Define par\u00e2metros opcionais da transa\u00e7\u00e3o setRequestParams( array $params # Array de par\u00e2metros opcionais: currency, languageMessages, entityCode, referenceNumber, merchantRef, merchantSession, addrMatch, purchaseRequest, user ): static # Retorna a inst\u00e2ncia do cliente para encadeamento Perfeito! Aqui est\u00e1 uma vers\u00e3o resumida e visual em tabela, mas pensada para refer\u00eancia r\u00e1pida \u2014 sem detalhes longos, apenas nomes e breve descri\u00e7\u00e3o: Par\u00e2metros Opcionais \u00b6 $aditionals ( setBillingParam ) \u00b6 Par\u00e2metro Descri\u00e7\u00e3o billAddrLine2 Endere\u00e7o linha 2 do billing billAddrLine3 Endere\u00e7o linha 3 do billing billAddrState Estado/Prov\u00edncia do billing shipAddrCountry Pa\u00eds do envio shipAddrCity Cidade do envio shipAddrLine1 Endere\u00e7o linha 1 do envio shipAddrPostCode C\u00f3digo postal do envio shipAddrState Estado/Prov\u00edncia do envio addrMatch 'Y' ou 'N' \u2014 copiar billing \u2192 shipping workPhone Telefone de trabalho ( ['cc' => '238', 'subscriber' => '9999999'] ) mobilePhone Telefone m\u00f3vel ( ['cc' => '238', 'subscriber' => '9999999'] ) acctID ID da conta do cliente acctInfo Array com informa\u00e7\u00f5es detalhadas da conta-utilizador: \ud83d\udec8 \u2022 chAccAgeInd \u2013 Idade da conta: ( 01 , 02 , 03 , 04 , 06 ) \u2022 chAccDate \u2013 Data de cria\u00e7\u00e3o da conta ( yyyyMMdd ) \u2022 chAccChange \u2013 Data da \u00faltima altera\u00e7\u00e3o da conta ( yyyyMMdd ) \u2022 chAccPwChange \u2013 Data da \u00faltima altera\u00e7\u00e3o da senha ( yyyyMMdd ) \u2022 chAccPwChangeInd \u2013 Indicador de mudan\u00e7a de senha ( 01-05 = chAccAgeInd ) \u2022 suspiciousAccActivity \u2013 Indica se h\u00e1 atividade suspeita ( 01 N\u00e3o, 02 Suspeito) $params ( setRequestParams ) \u00b6 Par\u00e2metro Descri\u00e7\u00e3o r\u00e1pida currency Moeda (ISO4217 ou c\u00f3digo interno) languageMessages 'pt' ou 'en' entityCode C\u00f3digo da entidade (pagamento de fatura) referenceNumber N\u00famero de refer\u00eancia (fatura ou servi\u00e7o) merchantRef Refer\u00eancia interna do comerciante merchantSession Identificador da sess\u00e3o do comerciante addrMatch Flag de correspond\u00eancia de endere\u00e7o purchaseRequest Array opcional com dados de 3DS user Array ou string com informa\u00e7\u00f5es do usu\u00e1rio Prepara\u00e7\u00e3o de transa\u00e7\u00f5es \u00b6 # Compra de produtos/servi\u00e7os preparePurchase( float|string $amount, # Valor da compra (float ou string) array $billing, # Dados de faturamento do cliente (billing) ?string $merchantRef = null, # Refer\u00eancia interna do comerciante (opcional) ?string $merchantSession = null # Sess\u00e3o interna do comerciante (opcional) ): static # Retorna a pr\u00f3pria inst\u00e2ncia para chaining # Pagamento de faturas prepareServicePayment( float|string $amount, # Valor do pagamento string $entity, # C\u00f3digo da entidade (ex: luz, \u00e1gua) string $reference, # N\u00famero de refer\u00eancia da fatura ?string $merchantRef = null, # Refer\u00eancia interna do comerciante (opcional) ?string $merchantSession = null # Sess\u00e3o interna do comerciante (opcional) ): static # Retorna a pr\u00f3pria inst\u00e2ncia para chaining # Recarga de celular prepareRecharge( float|string $amount, # Valor da recarga string $entity, # C\u00f3digo do operador ou servi\u00e7o de recarga string $number, # N\u00famero do telefone ou cart\u00e3o a recarregar ?string $merchantRef = null, # Refer\u00eancia interna do comerciante (opcional) ?string $merchantSession = null # Sess\u00e3o interna do comerciante (opcional) ): static # Retorna a pr\u00f3pria inst\u00e2ncia para chaining # Estorno/reembolso prepareRefund( float|string $amount, # Valor a ser estornado string $merchantRef, # Refer\u00eancia do comerciante da transa\u00e7\u00e3o original string $merchantSession, # Sess\u00e3o do comerciante da transa\u00e7\u00e3o original string $transactionID, # ID da transa\u00e7\u00e3o original string $clearingPeriod # Per\u00edodo de compensa\u00e7\u00e3o da transa\u00e7\u00e3o ): static # Retorna a pr\u00f3pria inst\u00e2ncia para chaining Execu\u00e7\u00e3o e resposta \u00b6 # Gera formul\u00e1rio HTML pronto para submiss\u00e3o ao gateway createPaymentForm( string $responseUrl # URL de callback do comerciante (onde o gateway envia a resposta) ): string # Retorna o HTML do formul\u00e1rio, pronto para envio autom\u00e1tico # Processa callback do gateway e retorna objeto ResponseResult processResponse( array $postData # Dados recebidos do gateway via POST (normalmente $_POST) ): ResponseResult # Retorna inst\u00e2ncia de ResponseResult com status, dados e DCC se houver # Cria objeto Receipt para gerar recibos HTML customizados receipt( ResponseResult|array $res # Pode ser o objeto ResponseResult ou um array de callback ): Receipt # Retorna inst\u00e2ncia de Receipt para gerar HTML do recibo ou salvar em arquivo 2. ResponseResult \u00b6 Namespace: Erilshk\\Vinti4Pay\\Models # Representa o resultado de uma transa\u00e7\u00e3o Propriedades \u00b6 status: string # Status da transa\u00e7\u00e3o (SUCCESS, ERROR, CANCELLED, INVALID_FINGERPRINT) message: string # Mensagem leg\u00edvel success: bool # true se transa\u00e7\u00e3o aprovada data: array # Dados brutos do callback debugInfo: ?array # Informa\u00e7\u00f5es de depura\u00e7\u00e3o dcc: ?array # Informa\u00e7\u00f5es de convers\u00e3o de moeda (DCC) detail: ?string # Detalhes adicionais de erro Constantes \u00b6 STATUS_SUCCESS STATUS_ERROR STATUS_CANCELLED STATUS_INVALID_FINGERPRINT M\u00e9todos \u00b6 getStatus(): string # Retorna status da transa\u00e7\u00e3o getMessage(): string # Retorna mensagem leg\u00edvel isSuccessful(): bool # Retorna true se aprovado isSuspicious(): bool # Retorna true se fingerprint inv\u00e1lida getData(): array # Retorna dados brutos getDebugInfo(): ?array # Retorna informa\u00e7\u00f5es de debug hasDcc(): bool # Retorna true se h\u00e1 DCC getDcc(): ?array # Retorna dados DCC getDetail(): ?string # Retorna detalhes adicionais hasInvalidFingerprint(&$result = null): ?string # Retorna fingerprint inv\u00e1lida se houver getStatusLabel(string $lang = 'en'): string # Retorna label leg\u00edvel do status getMerchantReceipt(): string # Retorna recibo do comerciante toArray(): array # Converte objeto em array jsonData(): string # Retorna dados JSON onSuccess(callable $callback): self # Executa callback se transa\u00e7\u00e3o aprovada onError(callable $callback): self # Executa callback se erro onCancel(callable $callback): self # Executa callback se cancelado 3. Receipt \u00b6 Namespace: Erilshk\\Vinti4Pay\\Models # Gera recibos HTML Construtor \u00b6 __construct(array $postedData, ?string $templatesPath = null) # Inicializa com dados do callback e template opcional M\u00e9todos \u00b6 getMessageType(): string # Retorna tipo da mensagem (transaction, refund, service) generateReceipt(?string $template = null, array $params = []): string # Gera HTML do recibo com template ou padr\u00e3o saveReceipt(string $outputPath, ?string $template = null, array $params = []): string # Salva HTML do recibo em arquivo getHtml(): string # Retorna \u00faltimo HTML gerado Observa\u00e7\u00f5es gerais \u00b6 Vinti4PayClient \u00e9 o ponto central para todas as opera\u00e7\u00f5es de pagamento. ResponseResult encapsula o retorno do gateway, permitindo acesso f\u00e1cil a status, mensagens e dados brutos. Receipt gera recibos HTML para visualiza\u00e7\u00e3o ou impress\u00e3o, podendo usar templates ou gerar layout padr\u00e3o.","title":"API Detalhada"},{"location":"reference/#api-vinti4pay-referencia-completa","text":"","title":"\ud83d\udee0\ufe0f API Vinti4Pay \u2013 Refer\u00eancia Completa"},{"location":"reference/#1-vinti4payclient","text":"Namespace: Erilshk\\Vinti4Pay # Classe principal para todas as opera\u00e7\u00f5es com a Vinti4Net","title":"1. Vinti4PayClient"},{"location":"reference/#construtor","text":"# Inicializa o cliente Vinti4Pay __construct( string $posID, # ID do ponto de venda (POS) string $posAutCode, # C\u00f3digo de autoriza\u00e7\u00e3o do POS ?string $endpoint = null # URL do endpoint da API (opcional, usado para ambiente de testes) )","title":"Construtor"},{"location":"reference/#configuracao","text":"# Define dados de faturamento do cliente setBillingParams( string $email, # Email do cliente string $country, # C\u00f3digo do pa\u00eds (ISO ou num\u00e9rico) string $city, # Cidade de faturamento string $address, # Endere\u00e7o de faturamento string $postCode, # C\u00f3digo postal array $aditional = [] # Campos opcionais (telefones, endere\u00e7o de envio, acctID, etc.) ): static # Retorna a inst\u00e2ncia do cliente para encadeamento de m\u00e9todos # Define par\u00e2metros opcionais da transa\u00e7\u00e3o setRequestParams( array $params # Array de par\u00e2metros opcionais: currency, languageMessages, entityCode, referenceNumber, merchantRef, merchantSession, addrMatch, purchaseRequest, user ): static # Retorna a inst\u00e2ncia do cliente para encadeamento Perfeito! Aqui est\u00e1 uma vers\u00e3o resumida e visual em tabela, mas pensada para refer\u00eancia r\u00e1pida \u2014 sem detalhes longos, apenas nomes e breve descri\u00e7\u00e3o:","title":"Configura\u00e7\u00e3o"},{"location":"reference/#parametros-opcionais","text":"","title":"Par\u00e2metros Opcionais"},{"location":"reference/#aditionals-setbillingparam","text":"Par\u00e2metro Descri\u00e7\u00e3o billAddrLine2 Endere\u00e7o linha 2 do billing billAddrLine3 Endere\u00e7o linha 3 do billing billAddrState Estado/Prov\u00edncia do billing shipAddrCountry Pa\u00eds do envio shipAddrCity Cidade do envio shipAddrLine1 Endere\u00e7o linha 1 do envio shipAddrPostCode C\u00f3digo postal do envio shipAddrState Estado/Prov\u00edncia do envio addrMatch 'Y' ou 'N' \u2014 copiar billing \u2192 shipping workPhone Telefone de trabalho ( ['cc' => '238', 'subscriber' => '9999999'] ) mobilePhone Telefone m\u00f3vel ( ['cc' => '238', 'subscriber' => '9999999'] ) acctID ID da conta do cliente acctInfo Array com informa\u00e7\u00f5es detalhadas da conta-utilizador: \ud83d\udec8 \u2022 chAccAgeInd \u2013 Idade da conta: ( 01 , 02 , 03 , 04 , 06 ) \u2022 chAccDate \u2013 Data de cria\u00e7\u00e3o da conta ( yyyyMMdd ) \u2022 chAccChange \u2013 Data da \u00faltima altera\u00e7\u00e3o da conta ( yyyyMMdd ) \u2022 chAccPwChange \u2013 Data da \u00faltima altera\u00e7\u00e3o da senha ( yyyyMMdd ) \u2022 chAccPwChangeInd \u2013 Indicador de mudan\u00e7a de senha ( 01-05 = chAccAgeInd ) \u2022 suspiciousAccActivity \u2013 Indica se h\u00e1 atividade suspeita ( 01 N\u00e3o, 02 Suspeito)","title":"$aditionals (setBillingParam)"},{"location":"reference/#params-setrequestparams","text":"Par\u00e2metro Descri\u00e7\u00e3o r\u00e1pida currency Moeda (ISO4217 ou c\u00f3digo interno) languageMessages 'pt' ou 'en' entityCode C\u00f3digo da entidade (pagamento de fatura) referenceNumber N\u00famero de refer\u00eancia (fatura ou servi\u00e7o) merchantRef Refer\u00eancia interna do comerciante merchantSession Identificador da sess\u00e3o do comerciante addrMatch Flag de correspond\u00eancia de endere\u00e7o purchaseRequest Array opcional com dados de 3DS user Array ou string com informa\u00e7\u00f5es do usu\u00e1rio","title":"$params (setRequestParams)"},{"location":"reference/#preparacao-de-transacoes","text":"# Compra de produtos/servi\u00e7os preparePurchase( float|string $amount, # Valor da compra (float ou string) array $billing, # Dados de faturamento do cliente (billing) ?string $merchantRef = null, # Refer\u00eancia interna do comerciante (opcional) ?string $merchantSession = null # Sess\u00e3o interna do comerciante (opcional) ): static # Retorna a pr\u00f3pria inst\u00e2ncia para chaining # Pagamento de faturas prepareServicePayment( float|string $amount, # Valor do pagamento string $entity, # C\u00f3digo da entidade (ex: luz, \u00e1gua) string $reference, # N\u00famero de refer\u00eancia da fatura ?string $merchantRef = null, # Refer\u00eancia interna do comerciante (opcional) ?string $merchantSession = null # Sess\u00e3o interna do comerciante (opcional) ): static # Retorna a pr\u00f3pria inst\u00e2ncia para chaining # Recarga de celular prepareRecharge( float|string $amount, # Valor da recarga string $entity, # C\u00f3digo do operador ou servi\u00e7o de recarga string $number, # N\u00famero do telefone ou cart\u00e3o a recarregar ?string $merchantRef = null, # Refer\u00eancia interna do comerciante (opcional) ?string $merchantSession = null # Sess\u00e3o interna do comerciante (opcional) ): static # Retorna a pr\u00f3pria inst\u00e2ncia para chaining # Estorno/reembolso prepareRefund( float|string $amount, # Valor a ser estornado string $merchantRef, # Refer\u00eancia do comerciante da transa\u00e7\u00e3o original string $merchantSession, # Sess\u00e3o do comerciante da transa\u00e7\u00e3o original string $transactionID, # ID da transa\u00e7\u00e3o original string $clearingPeriod # Per\u00edodo de compensa\u00e7\u00e3o da transa\u00e7\u00e3o ): static # Retorna a pr\u00f3pria inst\u00e2ncia para chaining","title":"Prepara\u00e7\u00e3o de transa\u00e7\u00f5es"},{"location":"reference/#execucao-e-resposta","text":"# Gera formul\u00e1rio HTML pronto para submiss\u00e3o ao gateway createPaymentForm( string $responseUrl # URL de callback do comerciante (onde o gateway envia a resposta) ): string # Retorna o HTML do formul\u00e1rio, pronto para envio autom\u00e1tico # Processa callback do gateway e retorna objeto ResponseResult processResponse( array $postData # Dados recebidos do gateway via POST (normalmente $_POST) ): ResponseResult # Retorna inst\u00e2ncia de ResponseResult com status, dados e DCC se houver # Cria objeto Receipt para gerar recibos HTML customizados receipt( ResponseResult|array $res # Pode ser o objeto ResponseResult ou um array de callback ): Receipt # Retorna inst\u00e2ncia de Receipt para gerar HTML do recibo ou salvar em arquivo","title":"Execu\u00e7\u00e3o e resposta"},{"location":"reference/#2-responseresult","text":"Namespace: Erilshk\\Vinti4Pay\\Models # Representa o resultado de uma transa\u00e7\u00e3o","title":"2. ResponseResult"},{"location":"reference/#propriedades","text":"status: string # Status da transa\u00e7\u00e3o (SUCCESS, ERROR, CANCELLED, INVALID_FINGERPRINT) message: string # Mensagem leg\u00edvel success: bool # true se transa\u00e7\u00e3o aprovada data: array # Dados brutos do callback debugInfo: ?array # Informa\u00e7\u00f5es de depura\u00e7\u00e3o dcc: ?array # Informa\u00e7\u00f5es de convers\u00e3o de moeda (DCC) detail: ?string # Detalhes adicionais de erro","title":"Propriedades"},{"location":"reference/#constantes","text":"STATUS_SUCCESS STATUS_ERROR STATUS_CANCELLED STATUS_INVALID_FINGERPRINT","title":"Constantes"},{"location":"reference/#metodos","text":"getStatus(): string # Retorna status da transa\u00e7\u00e3o getMessage(): string # Retorna mensagem leg\u00edvel isSuccessful(): bool # Retorna true se aprovado isSuspicious(): bool # Retorna true se fingerprint inv\u00e1lida getData(): array # Retorna dados brutos getDebugInfo(): ?array # Retorna informa\u00e7\u00f5es de debug hasDcc(): bool # Retorna true se h\u00e1 DCC getDcc(): ?array # Retorna dados DCC getDetail(): ?string # Retorna detalhes adicionais hasInvalidFingerprint(&$result = null): ?string # Retorna fingerprint inv\u00e1lida se houver getStatusLabel(string $lang = 'en'): string # Retorna label leg\u00edvel do status getMerchantReceipt(): string # Retorna recibo do comerciante toArray(): array # Converte objeto em array jsonData(): string # Retorna dados JSON onSuccess(callable $callback): self # Executa callback se transa\u00e7\u00e3o aprovada onError(callable $callback): self # Executa callback se erro onCancel(callable $callback): self # Executa callback se cancelado","title":"M\u00e9todos"},{"location":"reference/#3-receipt","text":"Namespace: Erilshk\\Vinti4Pay\\Models # Gera recibos HTML","title":"3. Receipt"},{"location":"reference/#construtor_1","text":"__construct(array $postedData, ?string $templatesPath = null) # Inicializa com dados do callback e template opcional","title":"Construtor"},{"location":"reference/#metodos_1","text":"getMessageType(): string # Retorna tipo da mensagem (transaction, refund, service) generateReceipt(?string $template = null, array $params = []): string # Gera HTML do recibo com template ou padr\u00e3o saveReceipt(string $outputPath, ?string $template = null, array $params = []): string # Salva HTML do recibo em arquivo getHtml(): string # Retorna \u00faltimo HTML gerado","title":"M\u00e9todos"},{"location":"reference/#observacoes-gerais","text":"Vinti4PayClient \u00e9 o ponto central para todas as opera\u00e7\u00f5es de pagamento. ResponseResult encapsula o retorno do gateway, permitindo acesso f\u00e1cil a status, mensagens e dados brutos. Receipt gera recibos HTML para visualiza\u00e7\u00e3o ou impress\u00e3o, podendo usar templates ou gerar layout padr\u00e3o.","title":"Observa\u00e7\u00f5es gerais"},{"location":"setup/","text":"\u2699\ufe0f Configura\u00e7\u00e3o do Cliente \u00b6 Ap\u00f3s instalar o SDK , o pr\u00f3ximo passo \u00e9 configurar o cliente principal, Vinti4PayClient , com as credenciais do seu Ponto de Venda (POS). 1. Instancia\u00e7\u00e3o do Cliente \u00b6 O Vinti4PayClient \u00e9 a classe central que voc\u00ea usar\u00e1 para preparar todas as transa\u00e7\u00f5es (compras, servi\u00e7os, recargas e estornos). Credenciais Necess\u00e1rias \u00b6 Voc\u00ea precisar\u00e1 das seguintes credenciais fornecidas pela Vinti4Net (SISP) para o seu POS: $posID : O ID do seu Ponto de Venda. $posAutCode : O C\u00f3digo de Autoriza\u00e7\u00e3o do POS (chave de seguran\u00e7a usada para gerar a fingerprint ). Exemplo de Configura\u00e7\u00e3o \u00b6 Utilize o namespace correto e passe as credenciais para o construtor: use Erilshk\\Vinti4Pay\\Vinti4PayClient; // Suas credenciais (Substitua pelos valores reais) $posID = '990000000'; $posAutCode = 'A1B2C3D4E5F67890'; /** * Cria a inst\u00e2ncia do cliente. * * @param string $posID O ID do Ponto de Venda. * @param string $posAutCode O C\u00f3digo de Autoriza\u00e7\u00e3o. * @param string|null $endpoint (Opcional) URL para ambiente de teste/staging. */ $client = new Vinti4PayClient($posID, $posAutCode); \ud83e\uddea Configura\u00e7\u00e3o para Testes ( Endpoint ) \u00b6 Se estiver trabalhando em um ambiente de homologa\u00e7\u00e3o ou teste que utilize um endpoint diferente do padr\u00e3o de produ\u00e7\u00e3o, voc\u00ea pode pass\u00e1-lo como o terceiro argumento opcional no construtor: // Use o endpoint fornecido pela Vinti4Net para o ambiente de testes $endpointTeste = '[https://sistemadetestes.vinti4net.cv/api](https://sistemadetestes.vinti4net.cv/api)'; $clientTeste = new Vinti4PayClient($posID, $posAutCode, $endpointTeste); 2. Par\u00e2metros Globais da Requisi\u00e7\u00e3o \u00b6 O m\u00e9todo setRequestParams() permite definir par\u00e2metros opcionais que ser\u00e3o aplicados a todas as transa\u00e7\u00f5es preparadas por esta inst\u00e2ncia do cliente. M\u00e9todo setRequestParams(array $params) \u00b6 Par\u00e2metro Descri\u00e7\u00e3o Tipo Exemplo currency Moeda da transa\u00e7\u00e3o (ISO 4217 code). Aceita c\u00f3digo ISO de 3 letras ou num\u00e9rico. string / int 'CVE' , 'USD' , 978 (EUR) languageMessages Idioma da p\u00e1gina de pagamento exibida ao cliente. string 'pt' (Portugu\u00eas), 'en' (Ingl\u00eas) entityCode C\u00f3digo da entidade (pode ser definido globalmente se o POS for espec\u00edfico para uma entidade). string '20002' referenceNumber N\u00famero de refer\u00eancia (geralmente definido por transa\u00e7\u00e3o, mas pode ser global). string '00123456789' user Informa\u00e7\u00f5es opcionais sobre o utilizador. array ['id' => 'user123'] Exemplo de uso: $client->setRequestParams([ 'currency' => 'CVE', // Transa\u00e7\u00f5es em Escudo Cabo-verdiano 'languageMessages' => 'pt', // Interface do Vinti4Net em Portugu\u00eas 'merchantRef' => 'REF-' . time(), // Pode pr\u00e9-definir uma base de refer\u00eancia ]); :warning: Aten\u00e7\u00e3o: Se um par\u00e2metro for definido em setRequestParams() e tamb\u00e9m no m\u00e9todo prepare* espec\u00edfico (ex: preparePurchase ), o valor definido no m\u00e9todo prepare* prevalecer\u00e1 para aquela transa\u00e7\u00e3o. 3. Lan\u00e7amento de Exce\u00e7\u00f5es \u00b6 O Vinti4PayClient utiliza a exce\u00e7\u00e3o customizada Vinti4Exception para indicar erros de valida\u00e7\u00e3o ou de l\u00f3gica de neg\u00f3cios, como tentar preparar uma nova transa\u00e7\u00e3o antes de finalizar a anterior: use Erilshk\\Vinti4Pay\\Exceptions\\Vinti4Exception; try { // ... c\u00f3digo de configura\u00e7\u00e3o e prepara\u00e7\u00e3o } catch (Vinti4Exception $e) { // Lidar com erro interno do SDK ou valida\u00e7\u00e3o inv\u00e1lida echo \"Erro de Configura\u00e7\u00e3o/Transa\u00e7\u00e3o: \" . $e->getMessage(); } Pr\u00f3ximo Passo: Com o cliente configurado, avance para a se\u00e7\u00e3o Uso para aprender a preparar as diferentes modalidades de transa\u00e7\u00e3o (compra, servi\u00e7o, etc.).","title":"Configura\u00e7\u00e3o"},{"location":"setup/#configuracao-do-cliente","text":"Ap\u00f3s instalar o SDK , o pr\u00f3ximo passo \u00e9 configurar o cliente principal, Vinti4PayClient , com as credenciais do seu Ponto de Venda (POS).","title":"\u2699\ufe0f Configura\u00e7\u00e3o do Cliente"},{"location":"setup/#1-instanciacao-do-cliente","text":"O Vinti4PayClient \u00e9 a classe central que voc\u00ea usar\u00e1 para preparar todas as transa\u00e7\u00f5es (compras, servi\u00e7os, recargas e estornos).","title":"1. Instancia\u00e7\u00e3o do Cliente"},{"location":"setup/#credenciais-necessarias","text":"Voc\u00ea precisar\u00e1 das seguintes credenciais fornecidas pela Vinti4Net (SISP) para o seu POS: $posID : O ID do seu Ponto de Venda. $posAutCode : O C\u00f3digo de Autoriza\u00e7\u00e3o do POS (chave de seguran\u00e7a usada para gerar a fingerprint ).","title":"Credenciais Necess\u00e1rias"},{"location":"setup/#exemplo-de-configuracao","text":"Utilize o namespace correto e passe as credenciais para o construtor: use Erilshk\\Vinti4Pay\\Vinti4PayClient; // Suas credenciais (Substitua pelos valores reais) $posID = '990000000'; $posAutCode = 'A1B2C3D4E5F67890'; /** * Cria a inst\u00e2ncia do cliente. * * @param string $posID O ID do Ponto de Venda. * @param string $posAutCode O C\u00f3digo de Autoriza\u00e7\u00e3o. * @param string|null $endpoint (Opcional) URL para ambiente de teste/staging. */ $client = new Vinti4PayClient($posID, $posAutCode);","title":"Exemplo de Configura\u00e7\u00e3o"},{"location":"setup/#configuracao-para-testes-endpoint","text":"Se estiver trabalhando em um ambiente de homologa\u00e7\u00e3o ou teste que utilize um endpoint diferente do padr\u00e3o de produ\u00e7\u00e3o, voc\u00ea pode pass\u00e1-lo como o terceiro argumento opcional no construtor: // Use o endpoint fornecido pela Vinti4Net para o ambiente de testes $endpointTeste = '[https://sistemadetestes.vinti4net.cv/api](https://sistemadetestes.vinti4net.cv/api)'; $clientTeste = new Vinti4PayClient($posID, $posAutCode, $endpointTeste);","title":"\ud83e\uddea Configura\u00e7\u00e3o para Testes (Endpoint)"},{"location":"setup/#2-parametros-globais-da-requisicao","text":"O m\u00e9todo setRequestParams() permite definir par\u00e2metros opcionais que ser\u00e3o aplicados a todas as transa\u00e7\u00f5es preparadas por esta inst\u00e2ncia do cliente.","title":"2. Par\u00e2metros Globais da Requisi\u00e7\u00e3o"},{"location":"setup/#metodo-setrequestparamsarray-params","text":"Par\u00e2metro Descri\u00e7\u00e3o Tipo Exemplo currency Moeda da transa\u00e7\u00e3o (ISO 4217 code). Aceita c\u00f3digo ISO de 3 letras ou num\u00e9rico. string / int 'CVE' , 'USD' , 978 (EUR) languageMessages Idioma da p\u00e1gina de pagamento exibida ao cliente. string 'pt' (Portugu\u00eas), 'en' (Ingl\u00eas) entityCode C\u00f3digo da entidade (pode ser definido globalmente se o POS for espec\u00edfico para uma entidade). string '20002' referenceNumber N\u00famero de refer\u00eancia (geralmente definido por transa\u00e7\u00e3o, mas pode ser global). string '00123456789' user Informa\u00e7\u00f5es opcionais sobre o utilizador. array ['id' => 'user123'] Exemplo de uso: $client->setRequestParams([ 'currency' => 'CVE', // Transa\u00e7\u00f5es em Escudo Cabo-verdiano 'languageMessages' => 'pt', // Interface do Vinti4Net em Portugu\u00eas 'merchantRef' => 'REF-' . time(), // Pode pr\u00e9-definir uma base de refer\u00eancia ]); :warning: Aten\u00e7\u00e3o: Se um par\u00e2metro for definido em setRequestParams() e tamb\u00e9m no m\u00e9todo prepare* espec\u00edfico (ex: preparePurchase ), o valor definido no m\u00e9todo prepare* prevalecer\u00e1 para aquela transa\u00e7\u00e3o.","title":"M\u00e9todo setRequestParams(array $params)"},{"location":"setup/#3-lancamento-de-excecoes","text":"O Vinti4PayClient utiliza a exce\u00e7\u00e3o customizada Vinti4Exception para indicar erros de valida\u00e7\u00e3o ou de l\u00f3gica de neg\u00f3cios, como tentar preparar uma nova transa\u00e7\u00e3o antes de finalizar a anterior: use Erilshk\\Vinti4Pay\\Exceptions\\Vinti4Exception; try { // ... c\u00f3digo de configura\u00e7\u00e3o e prepara\u00e7\u00e3o } catch (Vinti4Exception $e) { // Lidar com erro interno do SDK ou valida\u00e7\u00e3o inv\u00e1lida echo \"Erro de Configura\u00e7\u00e3o/Transa\u00e7\u00e3o: \" . $e->getMessage(); } Pr\u00f3ximo Passo: Com o cliente configurado, avance para a se\u00e7\u00e3o Uso para aprender a preparar as diferentes modalidades de transa\u00e7\u00e3o (compra, servi\u00e7o, etc.).","title":"3. Lan\u00e7amento de Exce\u00e7\u00f5es"},{"location":"usage/","text":"\ud83d\udcbb Utiliza\u00e7\u00e3o \u00b6 A classe principal Vinti4PayClient \u00e9 o motor do SDK, respons\u00e1vel por inicializar a transa\u00e7\u00e3o, validar os dados, gerar a fingerprint de seguran\u00e7a e construir o formul\u00e1rio de pagamento. O fluxo de uso geralmente segue tr\u00eas passos: Preparar Transa\u00e7\u00e3o: Chamar o m\u00e9todo prepare* espec\u00edfico (Ex: preparePurchase ). Configurar Billing: Definir os dados de cobran\u00e7a do cliente quando for compra ( preparePurchase ). Gerar Formul\u00e1rio: Chamar createPaymentForm() para obter o HTML de submiss\u00e3o. 1. Defini\u00e7\u00e3o dos Dados de Cobran\u00e7a ( setBillingParams ) \u00b6 A maioria das transa\u00e7\u00f5es de compra e algumas outras opera\u00e7\u00f5es exigem a defini\u00e7\u00e3o detalhada dos dados de cobran\u00e7a ( billing ) para atender aos requisitos de seguran\u00e7a (3D Secure/PCI). O m\u00e9todo setBillingParams() valida e define esses dados, e pode ser encadeado antes do m\u00e9todo de prepara\u00e7\u00e3o da transa\u00e7\u00e3o. Par\u00e2metros Obrigat\u00f3rios \u00b6 O m\u00e9todo exige os seguintes par\u00e2metros para o bloco de billing : Par\u00e2metro Tipo Descri\u00e7\u00e3o $email string Email do cliente (validado pelo SDK). $country string C\u00f3digo do Pa\u00eds de Cobran\u00e7a (ISO alpha-2 ou num\u00e9rico). $city string Cidade de Cobran\u00e7a. $address string Linha 1 do Endere\u00e7o de Cobran\u00e7a. $postCode string C\u00f3digo Postal/ZIP. Exemplo de Uso de setBillingParams \u00b6 // 1. Defina os dados essenciais $client->setBillingParams( email: 'cliente@exemplo.com', country: 'CV', // Cabo Verde (ou c\u00f3digo num\u00e9rico '132') city: 'Mindelo', address: 'Rua Principal, 123', postCode: '1000' ); // Voc\u00ea tamb\u00e9m pode passar um array com dados adicionais como o par\u00e2metro $aditional $client->setBillingParams( // ... Par\u00e2metros obrigat\u00f3rios // ... aditional: [ 'addrMatch' => 'Y', // Copia billing para shipping (se aplic\u00e1vel) 'billAddrState' => 'SV', // Estado/Prov\u00edncia 'mobilePhone' => ['cc' => '238', 'subscriber' => '9112233'] ] ); 2. Prepara\u00e7\u00e3o de Transa\u00e7\u00f5es \u00b6 O Vinti4PayClient oferece m\u00e9todos dedicados para cada tipo de opera\u00e7\u00e3o: A. Preparar Compra ( preparePurchase ) \u00b6 C\u00f3digo da Transa\u00e7\u00e3o: 1 Prepara uma transa\u00e7\u00e3o de compra tradicional, exigindo o montante e os dados de billing definidos. // Requer o array $billing completo. Se voc\u00ea usou setBillingParams(), // o array com os dados de billing est\u00e1 armazenado internamente. $client->preparePurchase( amount: 150.00, // Valor da compra billing: $billing, // Array de billing (se n\u00e3o usou setBillingParams) merchantRef: 'PEDIDO_XYZ_001', // Refer\u00eancia opcional merchantSession: 'SESSION_ABC_123' // Sess\u00e3o opcional ); B. Preparar Pagamento de Servi\u00e7o ( prepareServicePayment ) \u00b6 C\u00f3digo da Transa\u00e7\u00e3o: 2 Prepara um pagamento de fatura ou servi\u00e7o via SISP, exigindo o c\u00f3digo da entidade e o n\u00famero de refer\u00eancia. $client->prepareServicePayment( amount: 5000.00, entity: '20002', // C\u00f3digo da Entidade (Ex: Eletricidade) reference: '00123456789', // Refer\u00eancia da Fatura merchantRef: 'FATURA_ELE_10203' ); C. Preparar Recarga ( prepareRecharge ) \u00b6 C\u00f3digo da Transa\u00e7\u00e3o: 3 Prepara uma transa\u00e7\u00e3o de recarga (ex: telem\u00f3vel/celular), exigindo entidade e o n\u00famero a recarregar. $client->prepareRecharge( amount: 500.00, entity: '20003', // Ex: Operadora M\u00f3vel number: '991234567', // N\u00famero para Recarga merchantSession: 'REC_SESS_456' ); D. Preparar Estorno/Reembolso ( prepareRefund ) \u00b6 C\u00f3digo da Transa\u00e7\u00e3o: 'refund' Prepara uma transa\u00e7\u00e3o de estorno, que \u00e9 processada de forma diferente dos pagamentos diretos. $client->prepareRefund( amount: 15.00, merchantRef: 'ESTORNO_PEDIDO_001', merchantSession: 'SESSAO_ORIGINAL_XYZ', transactionID: 'ID_TRANSACAO_SIS_12345', // ID da transa\u00e7\u00e3o original clearingPeriod: '202401' // Per\u00edodo de compensa\u00e7\u00e3o (AAAA MM) ); \ud83c\udf1f Observa\u00e7\u00e3o: O SDK lan\u00e7a uma Vinti4Exception se voc\u00ea tentar preparar uma nova transa\u00e7\u00e3o sem que a anterior tenha sido processada (o objeto s\u00f3 pode preparar uma por vez). 3. Gerar o Formul\u00e1rio de Pagamento \u00b6 Ap\u00f3s a prepara\u00e7\u00e3o, voc\u00ea deve chamar o m\u00e9todo createPaymentForm() para obter o c\u00f3digo HTML que ser\u00e1 submetido ao gateway Vinti4Net. Par\u00e2metro Tipo Descri\u00e7\u00e3o $responseUrl string URL de Callback/Resposta onde o Vinti4Net enviar\u00e1 a resposta da transa\u00e7\u00e3o. $redirectMessage string Mensagem a ser exibida ao cliente enquanto o formul\u00e1rio \u00e9 submetido automaticamente. (opcional) Exemplo Final \u00b6 $responseUrl = 'https://seusite.com/vinti4_callback.php'; // 1. Prepara\u00e7\u00e3o (exemplo: compra) $client->preparePurchase( amount: 1000.00, billing: [], merchantRef: 'NOVO_PED_002' ); // 2. Definicao da fatura\u00e7\u00e3o $client->setBillingParams( email: $user['email'], country: $user['country'], city: $user['city'], address: $user['address'], postCode: $user['postCode'], aditional: [ 'user' => $user ]); // 3. Gera\u00e7\u00e3o do Formul\u00e1rio $htmlForm = $client->createPaymentForm($responseUrl); // 4. Imprima o formul\u00e1rio para submiss\u00e3o autom\u00e1tica via Javascript/HTML echo $htmlForm; O $htmlForm \u00e9 um formul\u00e1rio HTML que deve ser exibido diretamente ao cliente, que o submeter\u00e1 ao Vinti4Net. Pr\u00f3ximo Passo: Com a prepara\u00e7\u00e3o feita, aprenda a tratar as respostas na se\u00e7\u00e3o Callbacks e Respostas .","title":"Uso"},{"location":"usage/#utilizacao","text":"A classe principal Vinti4PayClient \u00e9 o motor do SDK, respons\u00e1vel por inicializar a transa\u00e7\u00e3o, validar os dados, gerar a fingerprint de seguran\u00e7a e construir o formul\u00e1rio de pagamento. O fluxo de uso geralmente segue tr\u00eas passos: Preparar Transa\u00e7\u00e3o: Chamar o m\u00e9todo prepare* espec\u00edfico (Ex: preparePurchase ). Configurar Billing: Definir os dados de cobran\u00e7a do cliente quando for compra ( preparePurchase ). Gerar Formul\u00e1rio: Chamar createPaymentForm() para obter o HTML de submiss\u00e3o.","title":"\ud83d\udcbb Utiliza\u00e7\u00e3o"},{"location":"usage/#1-definicao-dos-dados-de-cobranca-setbillingparams","text":"A maioria das transa\u00e7\u00f5es de compra e algumas outras opera\u00e7\u00f5es exigem a defini\u00e7\u00e3o detalhada dos dados de cobran\u00e7a ( billing ) para atender aos requisitos de seguran\u00e7a (3D Secure/PCI). O m\u00e9todo setBillingParams() valida e define esses dados, e pode ser encadeado antes do m\u00e9todo de prepara\u00e7\u00e3o da transa\u00e7\u00e3o.","title":"1. Defini\u00e7\u00e3o dos Dados de Cobran\u00e7a (setBillingParams)"},{"location":"usage/#parametros-obrigatorios","text":"O m\u00e9todo exige os seguintes par\u00e2metros para o bloco de billing : Par\u00e2metro Tipo Descri\u00e7\u00e3o $email string Email do cliente (validado pelo SDK). $country string C\u00f3digo do Pa\u00eds de Cobran\u00e7a (ISO alpha-2 ou num\u00e9rico). $city string Cidade de Cobran\u00e7a. $address string Linha 1 do Endere\u00e7o de Cobran\u00e7a. $postCode string C\u00f3digo Postal/ZIP.","title":"Par\u00e2metros Obrigat\u00f3rios"},{"location":"usage/#exemplo-de-uso-de-setbillingparams","text":"// 1. Defina os dados essenciais $client->setBillingParams( email: 'cliente@exemplo.com', country: 'CV', // Cabo Verde (ou c\u00f3digo num\u00e9rico '132') city: 'Mindelo', address: 'Rua Principal, 123', postCode: '1000' ); // Voc\u00ea tamb\u00e9m pode passar um array com dados adicionais como o par\u00e2metro $aditional $client->setBillingParams( // ... Par\u00e2metros obrigat\u00f3rios // ... aditional: [ 'addrMatch' => 'Y', // Copia billing para shipping (se aplic\u00e1vel) 'billAddrState' => 'SV', // Estado/Prov\u00edncia 'mobilePhone' => ['cc' => '238', 'subscriber' => '9112233'] ] );","title":"Exemplo de Uso de setBillingParams"},{"location":"usage/#2-preparacao-de-transacoes","text":"O Vinti4PayClient oferece m\u00e9todos dedicados para cada tipo de opera\u00e7\u00e3o:","title":"2. Prepara\u00e7\u00e3o de Transa\u00e7\u00f5es"},{"location":"usage/#a-preparar-compra-preparepurchase","text":"C\u00f3digo da Transa\u00e7\u00e3o: 1 Prepara uma transa\u00e7\u00e3o de compra tradicional, exigindo o montante e os dados de billing definidos. // Requer o array $billing completo. Se voc\u00ea usou setBillingParams(), // o array com os dados de billing est\u00e1 armazenado internamente. $client->preparePurchase( amount: 150.00, // Valor da compra billing: $billing, // Array de billing (se n\u00e3o usou setBillingParams) merchantRef: 'PEDIDO_XYZ_001', // Refer\u00eancia opcional merchantSession: 'SESSION_ABC_123' // Sess\u00e3o opcional );","title":"A. Preparar Compra (preparePurchase)"},{"location":"usage/#b-preparar-pagamento-de-servico-prepareservicepayment","text":"C\u00f3digo da Transa\u00e7\u00e3o: 2 Prepara um pagamento de fatura ou servi\u00e7o via SISP, exigindo o c\u00f3digo da entidade e o n\u00famero de refer\u00eancia. $client->prepareServicePayment( amount: 5000.00, entity: '20002', // C\u00f3digo da Entidade (Ex: Eletricidade) reference: '00123456789', // Refer\u00eancia da Fatura merchantRef: 'FATURA_ELE_10203' );","title":"B. Preparar Pagamento de Servi\u00e7o (prepareServicePayment)"},{"location":"usage/#c-preparar-recarga-preparerecharge","text":"C\u00f3digo da Transa\u00e7\u00e3o: 3 Prepara uma transa\u00e7\u00e3o de recarga (ex: telem\u00f3vel/celular), exigindo entidade e o n\u00famero a recarregar. $client->prepareRecharge( amount: 500.00, entity: '20003', // Ex: Operadora M\u00f3vel number: '991234567', // N\u00famero para Recarga merchantSession: 'REC_SESS_456' );","title":"C. Preparar Recarga (prepareRecharge)"},{"location":"usage/#d-preparar-estornoreembolso-preparerefund","text":"C\u00f3digo da Transa\u00e7\u00e3o: 'refund' Prepara uma transa\u00e7\u00e3o de estorno, que \u00e9 processada de forma diferente dos pagamentos diretos. $client->prepareRefund( amount: 15.00, merchantRef: 'ESTORNO_PEDIDO_001', merchantSession: 'SESSAO_ORIGINAL_XYZ', transactionID: 'ID_TRANSACAO_SIS_12345', // ID da transa\u00e7\u00e3o original clearingPeriod: '202401' // Per\u00edodo de compensa\u00e7\u00e3o (AAAA MM) ); \ud83c\udf1f Observa\u00e7\u00e3o: O SDK lan\u00e7a uma Vinti4Exception se voc\u00ea tentar preparar uma nova transa\u00e7\u00e3o sem que a anterior tenha sido processada (o objeto s\u00f3 pode preparar uma por vez).","title":"D. Preparar Estorno/Reembolso (prepareRefund)"},{"location":"usage/#3-gerar-o-formulario-de-pagamento","text":"Ap\u00f3s a prepara\u00e7\u00e3o, voc\u00ea deve chamar o m\u00e9todo createPaymentForm() para obter o c\u00f3digo HTML que ser\u00e1 submetido ao gateway Vinti4Net. Par\u00e2metro Tipo Descri\u00e7\u00e3o $responseUrl string URL de Callback/Resposta onde o Vinti4Net enviar\u00e1 a resposta da transa\u00e7\u00e3o. $redirectMessage string Mensagem a ser exibida ao cliente enquanto o formul\u00e1rio \u00e9 submetido automaticamente. (opcional)","title":"3. Gerar o Formul\u00e1rio de Pagamento"},{"location":"usage/#exemplo-final","text":"$responseUrl = 'https://seusite.com/vinti4_callback.php'; // 1. Prepara\u00e7\u00e3o (exemplo: compra) $client->preparePurchase( amount: 1000.00, billing: [], merchantRef: 'NOVO_PED_002' ); // 2. Definicao da fatura\u00e7\u00e3o $client->setBillingParams( email: $user['email'], country: $user['country'], city: $user['city'], address: $user['address'], postCode: $user['postCode'], aditional: [ 'user' => $user ]); // 3. Gera\u00e7\u00e3o do Formul\u00e1rio $htmlForm = $client->createPaymentForm($responseUrl); // 4. Imprima o formul\u00e1rio para submiss\u00e3o autom\u00e1tica via Javascript/HTML echo $htmlForm; O $htmlForm \u00e9 um formul\u00e1rio HTML que deve ser exibido diretamente ao cliente, que o submeter\u00e1 ao Vinti4Net. Pr\u00f3ximo Passo: Com a prepara\u00e7\u00e3o feita, aprenda a tratar as respostas na se\u00e7\u00e3o Callbacks e Respostas .","title":"Exemplo Final"},{"location":"standalone/","text":"\ud83d\udcb3 Vinti4PayClient Standalone \u2014 Integra\u00e7\u00e3o de Pagamentos Vinti4Net - SISP (PHP) \u00b6 Cliente standalone para integra\u00e7\u00e3o com o gateway de pagamentos Vinti4 (SISP Cabo Verde) . \ud83c\udf0d Vis\u00e3o Geral \u00b6 A classe Vinti4PayClient encapsula o processo de comunica\u00e7\u00e3o com o gateway de pagamentos Vinti4 (mantido pela SISP, Cabo Verde). Ela permite que comerciantes criem pagamentos online de forma segura e validada criptograficamente com fingerprints SHA-512 . Suporta os seguintes tipos de opera\u00e7\u00e3o: Tipo de Transa\u00e7\u00e3o Constante Descri\u00e7\u00e3o Compra TRANSACTION_TYPE_PURCHASE Pagamento comum com cart\u00e3o Pagamento de Servi\u00e7o TRANSACTION_TYPE_SERVICE_PAYMENT Ex: \u00e1gua, luz, etc. Recarga TRANSACTION_TYPE_RECHARGE Ex: carregamento de telem\u00f3vel Reembolso TRANSACTION_TYPE_REFUND Devolu\u00e7\u00e3o de valor ao cliente \u2699\ufe0f Requisitos \u00b6 PHP 8.1+ Extens\u00e3o bcmath Extens\u00e3o ext-hash Extens\u00e3o ext-json Servidor HTTPS (obrigat\u00f3rio para produ\u00e7\u00e3o) \ud83d\udce6 Instala\u00e7\u00e3o \u00b6 Basta incluir a classe no seu projeto: require_once 'Vinti4PayClient.php'; \ud83d\udd04 Fluxo Geral de Integra\u00e7\u00e3o \u00b6 Inicie o cliente: $client = new Vinti4PayClient($posID, $posAuthCode); Prepare a transa\u00e7\u00e3o: $client->preparePurchase(1500.00, $billingData, 'ORDER123'); // $client->prepareServicePayment(1500.00, $entity, $reference, 'FAT123'); // $client->prepareRecharge(1500.00, $entity, $number, 'R123'); \ud83d\udca1 S\u00f3 se pode preparar um tipo de transa\u00e7\u00e3o! Gere o formul\u00e1rio HTML de redirecionamento: echo $client->createPaymentForm('https://seusite.com/callback.php'); Receba e processe o retorno: $result = $client->processResponse($_POST); Valide o resultado: if ($result['success']) { // Pagamento aprovado } else { // Erro, cancelamento ou fraude } \ud83d\udca1 Exemplo Completo \u00b6 // Para previnir cache de resultados o que pode gerar problemas, desabilite o cache da pagina: header(\"Cache-Control: no-store, no-cache, must-revalidate, max-age=0\"); header(\"Cache-Control: post-check=0, pre-check=0\", false); header(\"Pragma: no-cache\"); postback.php \u00b6 <?php require_once 'Vinti4PayClient.php' ; $posID = '123456' ; $posAuthCode = 'SEU_AUTH_CODE' ; // Inicializa o cliente $vinti4 = new Vinti4PayClient ( $posID , $posAuthCode ); // Dados de faturamento $billing = [ 'billAddrCountry' => 'CV' , 'billAddrCity' => 'Praia' , 'billAddrLine1' => 'Av. Cidade Lisboa' , 'billAddrPostCode' => '7600' , 'email' => 'cliente@exemplo.cv' ]; // Prepara a compra $vinti4 -> preparePurchase ( 2500.00 , $billing , 'ORDER-2025-001' ); // Define par\u00e2metros opcionais $vinti4 -> setRequestParams ([ 'currency' => 'CVE' , 'languageMessages' => 'pt' ]); // Gera e envia o formul\u00e1rio echo $vinti4 -> createPaymentForm ( 'https://meusite.cv/retorno.php' ); callback.php \u00b6 <?php require_once 'Vinti4PayClient.php' ; $posID = '123456' ; $posAuthCode = 'SEU_AUTH_CODE' ; // Inicializa o cliente $vinti4 = new Vinti4PayClient ( $posID , $posAuthCode ); $vinti4 = new Vinti4PayClient ( $posID , $posAuthCode ); $result = $vinti4 -> processResponse ( $_POST ); if ( $result [ 'success' ]) { echo \"Pagamento confirmado!\" ; } else { echo \"Falha: \" . $result [ 'message' ]; } \ud83d\udcd8 Documenta\u00e7\u00e3o da Classe \u00b6 \ud83d\udd39 Construtor \u00b6 __construct(string $posID, string $posAuthCode, ?string $endpoint = null) Descri\u00e7\u00e3o: Inicializa o cliente com as credenciais fornecidas pelo SISP . Par\u00e2metro Tipo Descri\u00e7\u00e3o $posID string Identificador do POS fornecido pelo Vinti4. $posAuthCode string C\u00f3digo de autentica\u00e7\u00e3o do POS. $endpoint string null Endpoint do gateway. Padr\u00e3o: https://mc.vinti4net.cv/BizMPIOnUsSisp/CardPayment \ud83d\udd39 setRequestParams() \u00b6 Define par\u00e2metros opcionais da requisi\u00e7\u00e3o antes de criar o formul\u00e1rio. setRequestParams(array $params): static Par\u00e2metros permitidos: Par\u00e2metro Tipo Descri\u00e7\u00e3o currency string int languageMessages string Idioma das mensagens retornadas ( pt , en , etc.) entityCode string C\u00f3digo da entidade (para pagamentos de servi\u00e7o ou recarga) referenceNumber string Refer\u00eancia do pagamento merchantRef string C\u00f3digo interno da transa\u00e7\u00e3o merchantSession string Sess\u00e3o \u00fanica da transa\u00e7\u00e3o addrMatch string 'Y' se o endere\u00e7o de entrega for igual ao de faturamento purchaseRequest string JSON codificado da compra, normalmente gerado internamente \ud83d\udd39 preparePurchase() \u00b6 Prepara uma transa\u00e7\u00e3o de compra (Purchase) . preparePurchase(float|string $amount, array $billing, ?string $merchantRef = null, ?string $merchantSession = null): static Par\u00e2metro Tipo Descri\u00e7\u00e3o $amount float string Valor da compra. $billing array Dados de faturamento obrigat\u00f3rios. $merchantRef string null Refer\u00eancia do comerciante. $merchantSession string null Sess\u00e3o da transa\u00e7\u00e3o. Estrutura de $billing : \u00b6 Campo Obrigat\u00f3rio Descri\u00e7\u00e3o billAddrCountry \u2705 Pa\u00eds (ex: CV ) billAddrCity \u2705 Cidade billAddrLine1 \u2705 Endere\u00e7o billAddrPostCode \u2705 C\u00f3digo postal email \u2705 E-mail do cliente addrMatch \u274c 'Y' se endere\u00e7o de entrega = faturamento shipAddrCountry , shipAddrCity , shipAddrLine1 , shipAddrPostCode \u274c Endere\u00e7o de entrega (opcional) \ud83d\udd39 prepareServicePayment() \u00b6 prepareServicePayment(float|string $amount, string $entity, string $reference, ?string $merchantRef = null, ?string $merchantSession = null): static Prepara um pagamento de servi\u00e7o (Ex: contas de luz, \u00e1gua, etc.) \ud83d\udd39 prepareRecharge() \u00b6 prepareRecharge(float|string $amount, string $entity, string $number, ?string $merchantRef = null, ?string $merchantSession = null): static Prepara uma recarga (Ex: telem\u00f3vel). \ud83d\udd39 prepareRefund() \u00b6 prepareRefund(float|string $amount, string $merchantRef, string $merchantSession, string $transactionID, string $clearingPeriod): static Prepara uma opera\u00e7\u00e3o de reembolso . \ud83d\udd39 createPaymentForm() \u00b6 createPaymentForm(string $responseUrl, string $redirectMessage = \"Processando o pagamento...\"): string Gera o HTML de redirecionamento autom\u00e1tico para o gateway. \ud83d\udd39 processResponse() \u00b6 processResponse(array $postData): array Processa e valida a resposta enviada pelo Vinti4 ap\u00f3s o pagamento. Verifica: Cancelamento pelo usu\u00e1rio Tipo de transa\u00e7\u00e3o (pagamento/refund) C\u00e1lculo do fingerprint Verifica\u00e7\u00e3o de DCC Retorno de mensagens e erros Retorno: Array com: [ 'status' => 'SUCCESS|CANCELLED|INVALID_FINGERPRINT|ERROR', 'message' => '...', 'success' => true|false, 'data' => [...], 'dcc' => [...], 'debug' => [...], 'detail' => '...' ] \ud83e\udde9 Constantes Importantes \u00b6 Constante Valor Descri\u00e7\u00e3o DEFAULT_ENDPOINT https://mc.vinti4net.cv/BizMPIOnUsSisp/CardPayment Endpoint padr\u00e3o do gateway TRANSACTION_TYPE_PURCHASE '1' Compra TRANSACTION_TYPE_SERVICE_PAYMENT '2' Pagamento de servi\u00e7o TRANSACTION_TYPE_RECHARGE '3' Recarga TRANSACTION_TYPE_REFUND '4' Reembolso CURRENCY_CVE '132' C\u00f3digo CVE SUCCESS_MESSAGE_TYPES ['8', '10', 'P', 'M'] Mensagens que indicam sucesso \u26a0\ufe0f Erros Comuns \u00b6 Situa\u00e7\u00e3o Causa Solu\u00e7\u00e3o J\u00e1 existe uma transa\u00e7\u00e3o configurada neste objeto. Voc\u00ea chamou preparePurchase() duas vezes sem resetar Crie nova inst\u00e2ncia para cada transa\u00e7\u00e3o Invalid currency code C\u00f3digo de moeda inv\u00e1lido Use sigla ISO ( CVE , EUR , etc.) INVALID_FINGERPRINT Fingerprint divergente Verifique se $posAuthCode \u00e9 o mesmo do ambiente (produ\u00e7\u00e3o/homologa\u00e7\u00e3o) \ud83e\udde0 Boas Pr\u00e1ticas \u00b6 Gere sempre novas refer\u00eancias ( merchantRef , merchantSession ) por transa\u00e7\u00e3o. Use HTTPS no responseUrl . Armazene logs de retorno ( $_POST ) para auditoria. Nunca exponha o posAuthCode em JavaScript ou cliente final. \ud83d\udcc4 Licen\u00e7a \u00b6 C\u00f3digo livre para uso interno ou comercial. Distribu\u00eddo sob a licen\u00e7a MIT .","title":"Vint4PayClient"},{"location":"standalone/#vinti4payclient-standalone-integracao-de-pagamentos-vinti4net-sisp-php","text":"Cliente standalone para integra\u00e7\u00e3o com o gateway de pagamentos Vinti4 (SISP Cabo Verde) .","title":"\ud83d\udcb3 Vinti4PayClient Standalone \u2014 Integra\u00e7\u00e3o de Pagamentos Vinti4Net - SISP (PHP)"},{"location":"standalone/#visao-geral","text":"A classe Vinti4PayClient encapsula o processo de comunica\u00e7\u00e3o com o gateway de pagamentos Vinti4 (mantido pela SISP, Cabo Verde). Ela permite que comerciantes criem pagamentos online de forma segura e validada criptograficamente com fingerprints SHA-512 . Suporta os seguintes tipos de opera\u00e7\u00e3o: Tipo de Transa\u00e7\u00e3o Constante Descri\u00e7\u00e3o Compra TRANSACTION_TYPE_PURCHASE Pagamento comum com cart\u00e3o Pagamento de Servi\u00e7o TRANSACTION_TYPE_SERVICE_PAYMENT Ex: \u00e1gua, luz, etc. Recarga TRANSACTION_TYPE_RECHARGE Ex: carregamento de telem\u00f3vel Reembolso TRANSACTION_TYPE_REFUND Devolu\u00e7\u00e3o de valor ao cliente","title":"\ud83c\udf0d Vis\u00e3o Geral"},{"location":"standalone/#requisitos","text":"PHP 8.1+ Extens\u00e3o bcmath Extens\u00e3o ext-hash Extens\u00e3o ext-json Servidor HTTPS (obrigat\u00f3rio para produ\u00e7\u00e3o)","title":"\u2699\ufe0f Requisitos"},{"location":"standalone/#instalacao","text":"Basta incluir a classe no seu projeto: require_once 'Vinti4PayClient.php';","title":"\ud83d\udce6 Instala\u00e7\u00e3o"},{"location":"standalone/#fluxo-geral-de-integracao","text":"Inicie o cliente: $client = new Vinti4PayClient($posID, $posAuthCode); Prepare a transa\u00e7\u00e3o: $client->preparePurchase(1500.00, $billingData, 'ORDER123'); // $client->prepareServicePayment(1500.00, $entity, $reference, 'FAT123'); // $client->prepareRecharge(1500.00, $entity, $number, 'R123'); \ud83d\udca1 S\u00f3 se pode preparar um tipo de transa\u00e7\u00e3o! Gere o formul\u00e1rio HTML de redirecionamento: echo $client->createPaymentForm('https://seusite.com/callback.php'); Receba e processe o retorno: $result = $client->processResponse($_POST); Valide o resultado: if ($result['success']) { // Pagamento aprovado } else { // Erro, cancelamento ou fraude }","title":"\ud83d\udd04 Fluxo Geral de Integra\u00e7\u00e3o"},{"location":"standalone/#exemplo-completo","text":"// Para previnir cache de resultados o que pode gerar problemas, desabilite o cache da pagina: header(\"Cache-Control: no-store, no-cache, must-revalidate, max-age=0\"); header(\"Cache-Control: post-check=0, pre-check=0\", false); header(\"Pragma: no-cache\");","title":"\ud83d\udca1 Exemplo Completo"},{"location":"standalone/#postbackphp","text":"<?php require_once 'Vinti4PayClient.php' ; $posID = '123456' ; $posAuthCode = 'SEU_AUTH_CODE' ; // Inicializa o cliente $vinti4 = new Vinti4PayClient ( $posID , $posAuthCode ); // Dados de faturamento $billing = [ 'billAddrCountry' => 'CV' , 'billAddrCity' => 'Praia' , 'billAddrLine1' => 'Av. Cidade Lisboa' , 'billAddrPostCode' => '7600' , 'email' => 'cliente@exemplo.cv' ]; // Prepara a compra $vinti4 -> preparePurchase ( 2500.00 , $billing , 'ORDER-2025-001' ); // Define par\u00e2metros opcionais $vinti4 -> setRequestParams ([ 'currency' => 'CVE' , 'languageMessages' => 'pt' ]); // Gera e envia o formul\u00e1rio echo $vinti4 -> createPaymentForm ( 'https://meusite.cv/retorno.php' );","title":"postback.php"},{"location":"standalone/#callbackphp","text":"<?php require_once 'Vinti4PayClient.php' ; $posID = '123456' ; $posAuthCode = 'SEU_AUTH_CODE' ; // Inicializa o cliente $vinti4 = new Vinti4PayClient ( $posID , $posAuthCode ); $vinti4 = new Vinti4PayClient ( $posID , $posAuthCode ); $result = $vinti4 -> processResponse ( $_POST ); if ( $result [ 'success' ]) { echo \"Pagamento confirmado!\" ; } else { echo \"Falha: \" . $result [ 'message' ]; }","title":"callback.php"},{"location":"standalone/#documentacao-da-classe","text":"","title":"\ud83d\udcd8 Documenta\u00e7\u00e3o da Classe"},{"location":"standalone/#construtor","text":"__construct(string $posID, string $posAuthCode, ?string $endpoint = null) Descri\u00e7\u00e3o: Inicializa o cliente com as credenciais fornecidas pelo SISP . Par\u00e2metro Tipo Descri\u00e7\u00e3o $posID string Identificador do POS fornecido pelo Vinti4. $posAuthCode string C\u00f3digo de autentica\u00e7\u00e3o do POS. $endpoint string null Endpoint do gateway. Padr\u00e3o: https://mc.vinti4net.cv/BizMPIOnUsSisp/CardPayment","title":"\ud83d\udd39 Construtor"},{"location":"standalone/#setrequestparams","text":"Define par\u00e2metros opcionais da requisi\u00e7\u00e3o antes de criar o formul\u00e1rio. setRequestParams(array $params): static Par\u00e2metros permitidos: Par\u00e2metro Tipo Descri\u00e7\u00e3o currency string int languageMessages string Idioma das mensagens retornadas ( pt , en , etc.) entityCode string C\u00f3digo da entidade (para pagamentos de servi\u00e7o ou recarga) referenceNumber string Refer\u00eancia do pagamento merchantRef string C\u00f3digo interno da transa\u00e7\u00e3o merchantSession string Sess\u00e3o \u00fanica da transa\u00e7\u00e3o addrMatch string 'Y' se o endere\u00e7o de entrega for igual ao de faturamento purchaseRequest string JSON codificado da compra, normalmente gerado internamente","title":"\ud83d\udd39 setRequestParams()"},{"location":"standalone/#preparepurchase","text":"Prepara uma transa\u00e7\u00e3o de compra (Purchase) . preparePurchase(float|string $amount, array $billing, ?string $merchantRef = null, ?string $merchantSession = null): static Par\u00e2metro Tipo Descri\u00e7\u00e3o $amount float string Valor da compra. $billing array Dados de faturamento obrigat\u00f3rios. $merchantRef string null Refer\u00eancia do comerciante. $merchantSession string null Sess\u00e3o da transa\u00e7\u00e3o.","title":"\ud83d\udd39 preparePurchase()"},{"location":"standalone/#estrutura-de-billing","text":"Campo Obrigat\u00f3rio Descri\u00e7\u00e3o billAddrCountry \u2705 Pa\u00eds (ex: CV ) billAddrCity \u2705 Cidade billAddrLine1 \u2705 Endere\u00e7o billAddrPostCode \u2705 C\u00f3digo postal email \u2705 E-mail do cliente addrMatch \u274c 'Y' se endere\u00e7o de entrega = faturamento shipAddrCountry , shipAddrCity , shipAddrLine1 , shipAddrPostCode \u274c Endere\u00e7o de entrega (opcional)","title":"Estrutura de $billing:"},{"location":"standalone/#prepareservicepayment","text":"prepareServicePayment(float|string $amount, string $entity, string $reference, ?string $merchantRef = null, ?string $merchantSession = null): static Prepara um pagamento de servi\u00e7o (Ex: contas de luz, \u00e1gua, etc.)","title":"\ud83d\udd39 prepareServicePayment()"},{"location":"standalone/#preparerecharge","text":"prepareRecharge(float|string $amount, string $entity, string $number, ?string $merchantRef = null, ?string $merchantSession = null): static Prepara uma recarga (Ex: telem\u00f3vel).","title":"\ud83d\udd39 prepareRecharge()"},{"location":"standalone/#preparerefund","text":"prepareRefund(float|string $amount, string $merchantRef, string $merchantSession, string $transactionID, string $clearingPeriod): static Prepara uma opera\u00e7\u00e3o de reembolso .","title":"\ud83d\udd39 prepareRefund()"},{"location":"standalone/#createpaymentform","text":"createPaymentForm(string $responseUrl, string $redirectMessage = \"Processando o pagamento...\"): string Gera o HTML de redirecionamento autom\u00e1tico para o gateway.","title":"\ud83d\udd39 createPaymentForm()"},{"location":"standalone/#processresponse","text":"processResponse(array $postData): array Processa e valida a resposta enviada pelo Vinti4 ap\u00f3s o pagamento. Verifica: Cancelamento pelo usu\u00e1rio Tipo de transa\u00e7\u00e3o (pagamento/refund) C\u00e1lculo do fingerprint Verifica\u00e7\u00e3o de DCC Retorno de mensagens e erros Retorno: Array com: [ 'status' => 'SUCCESS|CANCELLED|INVALID_FINGERPRINT|ERROR', 'message' => '...', 'success' => true|false, 'data' => [...], 'dcc' => [...], 'debug' => [...], 'detail' => '...' ]","title":"\ud83d\udd39 processResponse()"},{"location":"standalone/#constantes-importantes","text":"Constante Valor Descri\u00e7\u00e3o DEFAULT_ENDPOINT https://mc.vinti4net.cv/BizMPIOnUsSisp/CardPayment Endpoint padr\u00e3o do gateway TRANSACTION_TYPE_PURCHASE '1' Compra TRANSACTION_TYPE_SERVICE_PAYMENT '2' Pagamento de servi\u00e7o TRANSACTION_TYPE_RECHARGE '3' Recarga TRANSACTION_TYPE_REFUND '4' Reembolso CURRENCY_CVE '132' C\u00f3digo CVE SUCCESS_MESSAGE_TYPES ['8', '10', 'P', 'M'] Mensagens que indicam sucesso","title":"\ud83e\udde9 Constantes Importantes"},{"location":"standalone/#erros-comuns","text":"Situa\u00e7\u00e3o Causa Solu\u00e7\u00e3o J\u00e1 existe uma transa\u00e7\u00e3o configurada neste objeto. Voc\u00ea chamou preparePurchase() duas vezes sem resetar Crie nova inst\u00e2ncia para cada transa\u00e7\u00e3o Invalid currency code C\u00f3digo de moeda inv\u00e1lido Use sigla ISO ( CVE , EUR , etc.) INVALID_FINGERPRINT Fingerprint divergente Verifique se $posAuthCode \u00e9 o mesmo do ambiente (produ\u00e7\u00e3o/homologa\u00e7\u00e3o)","title":"\u26a0\ufe0f Erros Comuns"},{"location":"standalone/#boas-praticas","text":"Gere sempre novas refer\u00eancias ( merchantRef , merchantSession ) por transa\u00e7\u00e3o. Use HTTPS no responseUrl . Armazene logs de retorno ( $_POST ) para auditoria. Nunca exponha o posAuthCode em JavaScript ou cliente final.","title":"\ud83e\udde0 Boas Pr\u00e1ticas"},{"location":"standalone/#licenca","text":"C\u00f3digo livre para uso interno ou comercial. Distribu\u00eddo sob a licen\u00e7a MIT .","title":"\ud83d\udcc4 Licen\u00e7a"},{"location":"standalone/callbacks/","text":"Callbacks e Respostas \u00b6 Ap\u00f3s o cliente ser redirecionado para o Vinti4Net e concluir (ou cancelar) a transa\u00e7\u00e3o, o gateway enviar\u00e1 uma resposta ( callback ) para a URL que voc\u00ea definiu em createPaymentForm() . O seu script nessa URL \u00e9 respons\u00e1vel por receber os dados, verificar a integridade da transa\u00e7\u00e3o e processar o resultado. 1. Processando a Resposta \u00b6 O m\u00e9todo processResponse(array $postData) \u00e9 o ponto de entrada para lidar com o callback . Ele realiza as seguintes tarefas: Determina\u00e7\u00e3o do Tipo: Identifica se \u00e9 uma resposta de Pagamento (Compra, Servi\u00e7o, Recarga) ou de Estorno (Refund). Valida\u00e7\u00e3o de Fingerprint: Verifica a chave de seguran\u00e7a ( fingerprint ) para garantir que os dados n\u00e3o foram adulterados. An\u00e1lise de Status: Analisa o c\u00f3digo de resposta e o status da transa\u00e7\u00e3o. Uso do processResponse \u00b6 O m\u00e9todo recebe o array de dados POST integral enviado pelo Vinti4Net (geralmente $_POST ). use Erilshk\\Vinti4Pay\\Vinti4PayClient; // 1. Instancie o cliente (com as mesmas credenciais usadas para a requisi\u00e7\u00e3o) $client = new Vinti4PayClient($posID, $posAutCode); // 2. Processa os dados POST recebidos do Vinti4Net $response = $client->processResponse($_POST); 2. Interpreta\u00e7\u00e3o do Array de Resposta \u00b6 O m\u00e9todo processResponse retorna um array associativo simples , contendo o status de processamento e os dados brutos da transa\u00e7\u00e3o. Estrutura do Array Retornado \u00b6 Chave Tipo Descri\u00e7\u00e3o success bool true se a transa\u00e7\u00e3o foi conclu\u00edda e aprovada . message string Mensagem descritiva do status (Ex: \"Aprovada\", \"Cancelada pelo usu\u00e1rio\"). status int C\u00f3digo de status interno do SDK (Ex: 0 para sucesso, 1 para falha, 2 para cancelamento). data array O array completo de dados POST recebidos do Vinti4Net. dcc array Dados de Dynamic Currency Conversion (DCC), se dispon\u00edveis. Exemplo de L\u00f3gica no Script de Callback \u00b6 Seu script de callback deve usar o elemento success para determinar a a\u00e7\u00e3o a ser tomada (atualizar o status do pedido, enviar confirma\u00e7\u00e3o, etc.). // ... (c\u00f3digo de instancia\u00e7\u00e3o e chamada ao processResponse) if ($responseArray['success'] === true) { // \ud83c\udf89 Sucesso // Obtenha os dados essenciais da transa\u00e7\u00e3o $transactionID = $responseArray['data']['transactionID'] ?? 'N/A'; $amount = $responseArray['data']['amount'] ?? 'N/A'; $ref = $responseArray['data']['merchantRef'] ?? 'N/A'; // A\u00e7\u00e3o: // - Registre o sucesso da transa\u00e7\u00e3o no banco de dados. // - Envie o email de confirma\u00e7\u00e3o ao cliente. echo \"<h1>Pagamento Aprovado!</h1>\"; echo \"<p>ID da Transa\u00e7\u00e3o: {$transactionID}</p>\"; } elseif ($responseArray['status'] === 2) { // \u270b Cancelamento // A\u00e7\u00e3o: // - Marque o pedido como cancelado pelo usu\u00e1rio. echo \"<h1>Transa\u00e7\u00e3o Cancelada</h1>\"; echo \"<p>O cliente cancelou a opera\u00e7\u00e3o no gateway.</p>\"; } else { // \u274c Falha ou Erro de Processamento // A\u00e7\u00e3o: // - Registre a falha e o motivo (message). echo \"<h1>Falha no Pagamento</h1>\"; echo \"<p>Motivo: {$responseArray['message']}</p>\"; } 3. C\u00f3digos de Resposta Comuns \u00b6 Embora o campo message forne\u00e7a um texto amig\u00e1vel, \u00e9 \u00fatil conhecer os c\u00f3digos de status mais comuns: status (interno SDK) Significado A\u00e7\u00e3o T\u00edpica 0 SUCESSO A transa\u00e7\u00e3o foi aprovada e conclu\u00edda. 1 FALHA A transa\u00e7\u00e3o foi negada pelo emissor ou houve erro de processamento. 2 CANCELAMENTO O usu\u00e1rio cancelou a transa\u00e7\u00e3o manualmente. -1 FINGERPRINT INV\u00c1LIDA Falha na verifica\u00e7\u00e3o de seguran\u00e7a (poss\u00edvel altera\u00e7\u00e3o dos dados). Requer investiga\u00e7\u00e3o! Pr\u00f3ximo Passo: Explore as outras funcionalidades do SDK, como a visualiza\u00e7\u00e3o do recibo, na se\u00e7\u00e3o Recibos .","title":"Callbacks e Respostas"},{"location":"standalone/callbacks/#callbacks-e-respostas","text":"Ap\u00f3s o cliente ser redirecionado para o Vinti4Net e concluir (ou cancelar) a transa\u00e7\u00e3o, o gateway enviar\u00e1 uma resposta ( callback ) para a URL que voc\u00ea definiu em createPaymentForm() . O seu script nessa URL \u00e9 respons\u00e1vel por receber os dados, verificar a integridade da transa\u00e7\u00e3o e processar o resultado.","title":"Callbacks e Respostas"},{"location":"standalone/callbacks/#1-processando-a-resposta","text":"O m\u00e9todo processResponse(array $postData) \u00e9 o ponto de entrada para lidar com o callback . Ele realiza as seguintes tarefas: Determina\u00e7\u00e3o do Tipo: Identifica se \u00e9 uma resposta de Pagamento (Compra, Servi\u00e7o, Recarga) ou de Estorno (Refund). Valida\u00e7\u00e3o de Fingerprint: Verifica a chave de seguran\u00e7a ( fingerprint ) para garantir que os dados n\u00e3o foram adulterados. An\u00e1lise de Status: Analisa o c\u00f3digo de resposta e o status da transa\u00e7\u00e3o.","title":"1. Processando a Resposta"},{"location":"standalone/callbacks/#uso-do-processresponse","text":"O m\u00e9todo recebe o array de dados POST integral enviado pelo Vinti4Net (geralmente $_POST ). use Erilshk\\Vinti4Pay\\Vinti4PayClient; // 1. Instancie o cliente (com as mesmas credenciais usadas para a requisi\u00e7\u00e3o) $client = new Vinti4PayClient($posID, $posAutCode); // 2. Processa os dados POST recebidos do Vinti4Net $response = $client->processResponse($_POST);","title":"Uso do processResponse"},{"location":"standalone/callbacks/#2-interpretacao-do-array-de-resposta","text":"O m\u00e9todo processResponse retorna um array associativo simples , contendo o status de processamento e os dados brutos da transa\u00e7\u00e3o.","title":"2. Interpreta\u00e7\u00e3o do Array de Resposta"},{"location":"standalone/callbacks/#estrutura-do-array-retornado","text":"Chave Tipo Descri\u00e7\u00e3o success bool true se a transa\u00e7\u00e3o foi conclu\u00edda e aprovada . message string Mensagem descritiva do status (Ex: \"Aprovada\", \"Cancelada pelo usu\u00e1rio\"). status int C\u00f3digo de status interno do SDK (Ex: 0 para sucesso, 1 para falha, 2 para cancelamento). data array O array completo de dados POST recebidos do Vinti4Net. dcc array Dados de Dynamic Currency Conversion (DCC), se dispon\u00edveis.","title":"Estrutura do Array Retornado"},{"location":"standalone/callbacks/#exemplo-de-logica-no-script-de-callback","text":"Seu script de callback deve usar o elemento success para determinar a a\u00e7\u00e3o a ser tomada (atualizar o status do pedido, enviar confirma\u00e7\u00e3o, etc.). // ... (c\u00f3digo de instancia\u00e7\u00e3o e chamada ao processResponse) if ($responseArray['success'] === true) { // \ud83c\udf89 Sucesso // Obtenha os dados essenciais da transa\u00e7\u00e3o $transactionID = $responseArray['data']['transactionID'] ?? 'N/A'; $amount = $responseArray['data']['amount'] ?? 'N/A'; $ref = $responseArray['data']['merchantRef'] ?? 'N/A'; // A\u00e7\u00e3o: // - Registre o sucesso da transa\u00e7\u00e3o no banco de dados. // - Envie o email de confirma\u00e7\u00e3o ao cliente. echo \"<h1>Pagamento Aprovado!</h1>\"; echo \"<p>ID da Transa\u00e7\u00e3o: {$transactionID}</p>\"; } elseif ($responseArray['status'] === 2) { // \u270b Cancelamento // A\u00e7\u00e3o: // - Marque o pedido como cancelado pelo usu\u00e1rio. echo \"<h1>Transa\u00e7\u00e3o Cancelada</h1>\"; echo \"<p>O cliente cancelou a opera\u00e7\u00e3o no gateway.</p>\"; } else { // \u274c Falha ou Erro de Processamento // A\u00e7\u00e3o: // - Registre a falha e o motivo (message). echo \"<h1>Falha no Pagamento</h1>\"; echo \"<p>Motivo: {$responseArray['message']}</p>\"; }","title":"Exemplo de L\u00f3gica no Script de Callback"},{"location":"standalone/callbacks/#3-codigos-de-resposta-comuns","text":"Embora o campo message forne\u00e7a um texto amig\u00e1vel, \u00e9 \u00fatil conhecer os c\u00f3digos de status mais comuns: status (interno SDK) Significado A\u00e7\u00e3o T\u00edpica 0 SUCESSO A transa\u00e7\u00e3o foi aprovada e conclu\u00edda. 1 FALHA A transa\u00e7\u00e3o foi negada pelo emissor ou houve erro de processamento. 2 CANCELAMENTO O usu\u00e1rio cancelou a transa\u00e7\u00e3o manualmente. -1 FINGERPRINT INV\u00c1LIDA Falha na verifica\u00e7\u00e3o de seguran\u00e7a (poss\u00edvel altera\u00e7\u00e3o dos dados). Requer investiga\u00e7\u00e3o! Pr\u00f3ximo Passo: Explore as outras funcionalidades do SDK, como a visualiza\u00e7\u00e3o do recibo, na se\u00e7\u00e3o Recibos .","title":"3. C\u00f3digos de Resposta Comuns"}]}